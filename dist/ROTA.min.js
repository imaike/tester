!function(t){function e(r){if(a[r])return a[r].exports;var o=a[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var a={};e.m=t,e.c=a,e.i=function(t){return t},e.d=function(t,a,r){e.o(t,a)||Object.defineProperty(t,a,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,"a",a),a},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=12)}({12:function(t,e){!function(t,e,a){!function(){e.setState("hasSplitFactor",0)}(),t.reInitializePlotAndChart=function(){if($.fn.dataTable.isDataTable("#twoFactorDisplayTable")){var e=[{respondent:"",factor1:0,factor2:0}],a=[];t.drawD3Chart(e),t.updateDatatable1(a,!1)}},t.saveRotationArchiveCounter=function(t){var a=e.getState("saveRotationCounter");if("increase"===t)a+=1,e.setState("saveRotationCounter",a);else if("decrease"===t)a-=1,e.setState("saveRotationCounter",a);else{if("get"===t)return a;"reset"===t&&e.setState("saveRotationCounter",1)}},t.saveRotationButtonColor=function(t){var e=$("#saveRotationButton");0!==t?(e.removeClass("saveRotationButtonGray"),e.addClass("saveRotationButtonYellow")):(e.removeClass("saveRotationButtonYellow"),e.addClass("saveRotationButtonGray"))},t.setRotationFactorsFromCheckbox=function(){for(var t=[],a=document.getElementsByName("radioCheck"),r=0;r<a.length;r++)a[r].checked&&t.push(a[r].value);if(null!==t){var o=t[0],n=t[1];e.setState("rotationFactorA",o),e.setState("rotationFactorB",n)}},t.doD3ChartDataPrep=function(t){var a,r,o,n,i,s,c,l,u=e.getState("rotationFactorA"),d=e.getState("rotationFactorB"),f=e.getState("qavRespondentNames"),g=e.getState("fSigCriterionResults"),p=_.cloneDeep(t),h=[],v=[];o=p.length;for(var S=0;S<o;S++)a=p[S],r=g[S],l={num:S+1,respondent:f[S],factor1:a[u-1],factor1Sig:r[u-1],factor2:a[d-1],factor2Sig:r[d-1]},h.push(l);return n=[],i="",s="Factor "+u,c="Factor "+d,n.push(i,s,c),v.unshift(n),h},t.drawD3Chart=function(t){var a,r,o,n,i,s,c,l=e.getState("rotationFactorA"),u=e.getState("rotationFactorB"),d=e.getState("rotChartConfig");d3.select("#d3_scatterchart svg").remove(),!0===d.removeCircleHighlight?(a="rgba(33, 33, 33, 0.0)",r="rgba(33, 33, 33, 0.0)",s="rgba(33, 33, 33, 0.0)"):(a=d.significanceColorAPrep,r=d.significanceColorBPrep,s="#d8d8d8"),o=!0===d.removeCircles?"rgba(33, 33, 33, 0.0)":"#000000",n=!0===d.identifierNumber?"number":"name",c=!0===d.changeFontSize?d.customFontSize+"px":"9px",i=t;var f=$(window).width()/2.25,g={top:20,right:10,bottom:40,left:40},p=f-g.left-g.right,h=f-g.top-g.bottom,v=function(t){return t.factor2},S=d3.scale.linear().range([0,p]),m=function(t){return S(v(t))},y=d3.svg.axis().scale(S).orient("bottom").ticks(2).tickSize(-h,0,0).tickPadding(10),b=function(t){return t.factor1},C=d3.scale.linear().range([h,0]),R=function(t){return C(b(t))},F=d3.svg.axis().scale(C).orient("left").ticks(2).tickSize(-p,0,0).tickPadding(10),x=d3.select("#d3_scatterchart").append("svg").attr("width",p+g.left+g.right).attr("height",h+g.top+g.bottom).attr("font-family","Arial").attr("id","scatterChart").append("g").attr("transform","translate("+g.left+","+g.top+")");i.forEach(function(t){t.factor1=+t.factor1,t.factor2=+t.factor2,t.factor1Sig=t.factor1Sig+"",t.factor2Sig=t.factor2Sig+""});var D,A=d3.max(i,v),w=d3.min(i,v),T=d3.max(i,b),B=d3.min(i,b),k=[A,w,T,B],N=_.max(k),P=_.min(k);D=N>1||P<-1?N>-P?N:-P:1,S.domain([-D,+D]),C.domain([-D,+D]);var z=d3.select("#d3_scatterchart").append("div").attr("class","d3Tooltip").style("opacity",0);x.append("g").attr("class","x axis").attr("transform","translate(0,"+h+")").call(y).append("text").attr("class","label").attr("x",p).attr("y",-6).style("font-family","Arial").style("text-anchor","end"),x.append("text").attr("x",p/2).attr("y",h+35).style("text-anchor","middle").style("font-family","Arial").style("font-weight","bold").text("Factor "+u),x.append("g").attr("class","y axis").call(F).append("text").attr("class","label").attr("transform","rotate(-90)").attr("y",6).attr("dy",".71em").style("font-family","Arial").style("text-anchor","end"),x.append("text").attr("transform","rotate(-90)").attr("y",0-g.left).attr("x",0-h/2).attr("dy","1em").style("text-anchor","middle").style("font-family","Arial").style("font-weight","bold").text("Factor "+l);var L=x.selectAll("g.node").data(i,function(t){return t.num}),M=L.enter().append("g").attr("class","node").attr("transform",function(t){return"translate("+m(t)+","+R(t)+")"});M.append("circle").attr("r",9).attr("class","dot").style("stroke",o).style("fill",function(t){return"true"===t.factor1Sig?a:"true"===t.factor2Sig?r:s}).on("mouseover",function(t){z.transition().duration(100).style("opacity",1),z.html("<strong>"+t.respondent+"</strong><br>"+b(t)+", 　"+v(t)).style("left",d3.event.pageX+10+"px").style("top",d3.event.pageY-28+"px")}).on("mouseout",function(){z.transition().duration(500).style("opacity",0)}),M.append("text").style("text-anchor","middle").attr("class","dotText").attr("font-family","Arial").attr("font-size",c).attr("dy",3).text(function(t){return"number"===n?t.num:t.respondent}).on("mouseover",function(t){z.transition().duration(100).style("opacity",1),z.html("<strong>"+t.respondent+"</strong><br>"+b(t)+", 　"+v(t)).style("left",d3.event.pageX+10+"px").style("top",d3.event.pageY-28+"px")}).on("mouseout",function(){z.transition().duration(500).style("opacity",0)})},t.calculateFactorLoadingSignificanceLevel=function(t){return evenRound(1/Math.sqrt(t)*1.96,5)},t.calculateCommunalities=function(t){function a(t){return t*t}var r,o,n,i,s,c,l,u=_.cloneDeep(t),d=[],f=[];for(_.forEach(u,function(t){r=_.map(t,a),o=r.reduce(function(t,e){return t+e},0),n=evenRound(o,5),d.push(n),i=[];for(var e=0,s=r.length;e<s;e++)c=evenRound(r[e],5),i.push(c);f.push(i)}),e.setState("fSigCriterion",f),e.setState("rowH2",d),l=u.length,s=0;s<l;s++)u[s].push(d[s]);return u},t.calculatefSigCriterionValues=function(a){var r,o,n,i,s,c,l,u,d,f=e.getState("fSigCriterion"),g=e.getState("qavOriginalSortSize"),p=t.calculateFactorLoadingSignificanceLevel(g),h=p*p,v=f.length,S=f[0].length,m=[];for(l=0;l<v;l++){for(r=f[l],d=[],u=0;u<S;u++)s=_.clone(r),o=_.pullAt(s,u),i=s.reduce(function(t,e){return t+e},0),n=evenRound(i,5),c="flag"===a&&o>n&&o>h?"true":"false",d.push(c);m.push(d)}e.setState("fSigCriterionResults",m)},t.calcSinDegrees=function(t){return Math.sin(t*(Math.PI/180))},t.calcCosDegrees=function(t){return Math.cos(t*(Math.PI/180))},t.newRotateClockwise=function(e,a){for(var r,o,n,i,s,c,l,u=_.zip.apply(_,e),d=t.calcSinDegrees(a),f=t.calcCosDegrees(a),g=u[0].length,p=[],h=0;h<g;h++)i=u[1][h]*d,s=u[0][h]*f,r=evenRound(i+s,5),c=u[0][h]*d,l=u[1][h]*f,o=evenRound(-(c-l),5),n=[],n[0]=r,n[1]=o,p.push(n);return p},t.newRotateCounterClockwise=function(e,a){for(var r,o,n,i,s,c,l=_.zip.apply(_,e),u=t.calcSinDegrees(a),d=t.calcCosDegrees(a),f=l[0].length,g=[],p=0;p<f;p++){n=l[1][p]*u,i=l[0][p]*d,r=evenRound(-(n-i),5),s=l[0][p]*u,c=l[1][p]*d,o=evenRound(s+c,5);var h=[];h[0]=r,h[1]=o,g.push(h)}return g},t.calculateRotatedFactors=function(a){var r,o=e.getState("rotationFactorA"),n=e.getState("rotationFactorB"),i=!1,s=e.getState("calculateRotationsArray"),c=e.getState("tempRotFacStateArray"),l=s.length;a<0&&(i=!0),a=Math.abs(a),r=!0!==i?t.newRotateClockwise(s,a):t.newRotateCounterClockwise(s,a);for(var u=0;u<l;u++)c[u][o-1]=r[u][0],c[u][n-1]=r[u][1];t.setTwoFactorRotationalArray(c);var d=t.calculateCommunalities(c);t.calculatefSigCriterionValues("flag");var f=t.doD3ChartDataPrep(d);t.drawD3Chart(f);var g=t.prepTwoFactorUpdateHandsontable(c);t.updateDatatable1(g,!1),e.setState("calculateRotationsArray",r),e.setState("tempRotFacStateArray",c)},t.prepTwoFactorUpdateHandsontable=function(t){var a,r,o,n,i=[],s=e.getState("rotationFactorA"),c=e.getState("rotationFactorB"),l=e.getState("fSigCriterionResults"),u=e.getState("qavRespondentNames"),d=t.length;for(r=0;r<d;r++)a=t[r],o=l[r],n={respondent:u[r],factor1:a[s-1],factor1Sig:o[s-1],factor2:a[c-1],factor2Sig:o[c-1]},i.push(n);return i},t.setTwoFactorRotationalArray=function(t){for(var a,r,o,n=e.getState("rotationFactorA"),i=e.getState("rotationFactorB"),s=t.length,c=[],l=0;l<s;l++)a=[],r=t[l][n-1],o=t[l][i-1],a.push(r,o),c.push(a);return e.setState("calculateRotationsArray",c),c},t.updateDatatable1=function(t,a){var r,o,n,i,s,c,l,u,d,f,g,p,h,v,S,m=[];S=$.fn.dataTable.isDataTable("#twoFactorDisplayTable");var y=e.getState("rotationFactorA"),b=e.getState("rotationFactorB"),C="Fac. "+y,R="Chg. "+y,F="Fac. "+b,x="Chg. "+b,D=["Res.","Name",C,R,F,x],A=e.getState("rotChartConfig"),w=A.significanceColorA,T=A.significanceColorB;if(!0===A.removeCircleHighlight&&(w="rgba(33, 33, 33, 0.0)",T="rgba(33, 33, 33, 0.0)"),!0===S){for(o=e.getState("baseLineData"),m=[],r=0;r<t.length;r++)n=[],s=r+1,n.push(s),i=t[r].respondent,n.push(i),c=t[r].factor1,n.push(c),l=o[r].factor1,u=evenRound(c-l,5),n.push(u),d=t[r].factor2,n.push(d),g=o[r].factor2,f=evenRound(d-g,5),n.push(f),h=t[r].factor1Sig,v=t[r].factor2Sig,n.push(h,v),m.push(n);p=$("#twoFactorDisplayTable").DataTable(),p.clear();for(var _=0;_<D.length;_++)p.columns(_).header().to$().text(D[_]);p.rows.add(m).draw()}else{for(o=e.getState("baseLineData"),null===o&&(o=[1,"",0,0,0,0]),r=0;r<t.length;r++)n=[],s=r+1,n.push(s),i=t[r].respondent,n.push(i),c=t[r].factor1,n.push(c),l=o[r].factor1,u=evenRound(c-l,5),n.push(u),d=t[r].factor2,n.push(d),g=o[r].factor2,f=evenRound(d-g,5),n.push(f),h=t[r].factor1Sig,v=t[r].factor2Sig,n.push(h,v),m.push(n);p=$("#twoFactorDisplayTable").DataTable({retrieve:!0,searching:!1,ordering:!0,info:!1,scrollY:600,scrollCollapse:!0,scrollX:!0,paging:!1,columnDefs:[{targets:[2,3,4,5],className:"dt-body-right"},{targets:[0,1],className:"dt-body-center"},{targets:[0],orderData:[0,1]},{targets:[2],orderData:[2]},{targets:[3],orderData:[3]},{targets:[4],orderData:[4]},{targets:[5],orderData:[5]},{targets:[6],visible:!1},{targets:[7],visible:!1},{targets:[2],createdCell:function(t,e,a){"true"===a[6]&&$(t).css("background",w)}},{targets:[4],createdCell:function(t,e,a){"true"===a[7]&&$(t).css("background",T)}}],data:m,columns:[{title:"Res.",className:"dt-head-center dt-body-center"},{title:"Name",className:"dt-head-center dt-body-center"},{title:C,className:"dt-head-center dt-body-right"},{title:R,className:"dt-head-center dt-body-right"},{title:F,className:"dt-head-center dt-body-right"},{title:x,className:"dt-head-center dt-body-right"}]}),p.fixedHeader.adjust()}},t.saveRotation=function(){var a,r,o=sessionStorage.getItem("rotationDegreeDisplayValue"),n=e.getState("rotationFactorA"),i=e.getState("rotationFactorB");UTIL.archiveFactorScoreStateMatrixAndDatatable();var s=e.getState("language"),c=resources[s].translation.Factors,l=resources[s].translation.and,u=resources[s].translation.rotated,d=resources[s].translation["rotated degrees"],f=resources[s].translation.Undo;a=c+n+l+i+u+o+d,$("#rotationHistoryList").append("<li>"+a+'<button class="deleteButton">'+f+"</button></li>"),e.getState("rotFacStateArray"),r=e.getState("tempRotFacStateArray"),e.setState("rotFacStateArray",r);LOAD.drawRotatedFactorsTable2("destroy","noFlag"),t.reInitializePlotAndChart(),$("#handRotationDisplayContainer div").html("0&deg"),sessionStorage.setItem("rotationDegreeDisplayValue",0),t.saveRotationButtonColor(0),e.setState("outputComplete","false")},t.calculateEigenvaluesAndVariance2=function(){var t,a,r,o,n=e.getState("qavTotalNumberSorts"),i=e.getState("rotFacStateArray"),s=_.zip.apply(_,i),c={},l={},u=s.length,d=[];for(c=["Eigenvalues"],l=["% Expln Var"],t=0;t<u;t++){a=s[t];for(var f=0;f<a.length;f++)a[f]=evenRound(a[f]*a[f],8);r=evenRound(_.reduce(a,function(t,e){return t+e}),5),"factor"+(t+1),"factorSig"+(t+1),o=evenRound(r/n*100,0),c.push(r),l.push(o),c.push(""),l.push("")}return c.push(""),l.push(""),d.push(c),l.splice(1,0,"",""),e.setState("expVar",l),d}}(window.ROTA=window.ROTA||{},QAV)}});