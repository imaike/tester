!function(I){function g(A){if(C[A])return C[A].exports;var n=C[A]={i:A,l:!1,exports:{}};return I[A].call(n.exports,n,n.exports,g),n.l=!0,n.exports}var C={};g.m=I,g.c=C,g.i=function(I){return I},g.d=function(I,C,A){g.o(I,C)||Object.defineProperty(I,C,{configurable:!1,enumerable:!0,get:A})},g.n=function(I){var C=I&&I.__esModule?function(){return I.default}:function(){return I};return g.d(C,"a",C),C},g.o=function(I,g){return Object.prototype.hasOwnProperty.call(I,g)},g.p="",g(g.s=5)}({5:function(module,exports){eval('//Ken-Q Analysis\n//Copyright (C) 2016 Shawn Banasick\n//\n//    This program is free software: you can redistribute it and/or modify\n//    it under the terms of the GNU General Public License as published by\n//    the Free Software Foundation, either version 3 of the License, or\n//    (at your option) any later version.\n\n// JSlint declarations\n/* global window, QAV, $, FileReader, UTIL, document */\n\n(function (FIREBASE, QAV, undefined) {\n    \'use strict\';\n\n    FIREBASE.filePickedJSON = function (evt) {\n        var JsonObj;\n        var files = evt.target.files; // FileList object\n        var f = files[0];\n        var reader = new FileReader();\n\n        // Closure to capture the file information.\n        reader.onload = (function () { // theFile\n            return function (e) {\n                // Render thumbnail.\n                JsonObj = e.target.result;\n                var jsonObjFile = JSON.parse(JsonObj);\n                QAV.setState("JsonObj", jsonObjFile);\n                FIREBASE.setRespondentId(jsonObjFile);\n            };\n        })(f);\n        // Read in the image file as a data URL.\n        reader.readAsText(f);\n    };\n\n    FIREBASE.setRespondentId = function (JsonObj) {\n        $(".jsonSelect").show();\n        $(".downloadCsvDataDiv").show();\n        var keys = Object.keys(JsonObj);\n        var responseObjectKeys = Object.keys(JsonObj[keys[0]]);\n        var projectName = JsonObj[keys[0]].name;\n        QAV.setState("qavProjectName", projectName);\n        $(".jsonFileName").html(\'"\' + projectName + \'" loaded\');\n        $.each(responseObjectKeys, function (key, value) {\n            $(\'#jsonIdSelect\')\n                .append($(\'<option>\', {\n                        value: key\n                    })\n                    .text(value));\n        });\n    };\n\n    FIREBASE.stageJsonData = function () {\n        var arr, array1, j, k, m, id, JsonObj, temp5, keys, i, sort0, temp1, tempString1, sortArray, iLen, mLen, kLen, sort2, sort3, jLen, replaced, prev, statementInput; \n        var qavRespondentNames, qavRespondentSortsFromDbStored, qavSortTriangleShape, multiplierArray, displaySortsArray;\n\n        // clear out any previously loaded data\n        $("#existingDatabaseStatementList").empty();\n        $("#existingDatabaseRespondentList").empty();\n\n        // grab statement data from DOM input\n        statementInput = document.getElementById("statementsInputBoxJson").value;\n\n        // process statements from text to data\n        array1 = FIREBASE.processStatementInput(statementInput);\n        QAV.setState("qavCurrentStatements", array1);\n        QAV.setState("qavOriginalSortSize", array1.length);\n        QAV.setState("originalSortSize", array1.length);\n\n        // append statements to the DOM\n        for (k = 0, kLen = array1.length; k < kLen; k++) {\n            $("#existingDatabaseStatementList").append("<li>" + array1[k] + "</li>");\n        }\n\n        // grab the id selection from DOM\n        id = $("#jsonIdSelect :selected").text();\n        JsonObj = QAV.getState("JsonObj");\n\n        // pull names and sorts from JSON data\n        var respondentNamesAndSorts = FIREBASE.pullRespondentNamesAndSortInformation(JsonObj, id);\n        displaySortsArray = respondentNamesAndSorts[0];\n        qavRespondentSortsFromDbStored = respondentNamesAndSorts[1];\n        keys = respondentNamesAndSorts[2];\n        sort0 = respondentNamesAndSorts[3];\n        qavRespondentNames = respondentNamesAndSorts[4];\n\n        // append sorts to the DOM\n        for (var ii = 0, iiLen = displaySortsArray.length; ii < iiLen; ii++) {\n            $("#existingDatabaseRespondentList").append(\'<li>\' + displaySortsArray[ii] + \'<button class="deleteButtonSort vertical">delete sort</button></li>\');\n        }\n\n        // calculate sort design pattern\n        qavSortTriangleShape = FIREBASE.calculateSortDesignPattern(JsonObj, keys, sort0);\n\n        // calculate multiplierArray\n        multiplierArray = FIREBASE.calculateMultiplierArray(qavSortTriangleShape);\n\n        QAV.setState("multiplierArray", multiplierArray);\n        QAV.setState("qavSortTriangleShape", qavSortTriangleShape);\n        QAV.setState("qavRespondentNames", qavRespondentNames);\n        QAV.setState("qavRespondentSortsFromDbStored", qavRespondentSortsFromDbStored);\n    };\n\n    FIREBASE.calculateMultiplierArray = function (qavSortTriangleShape) {\n        var multiplierArray = [];\n        var prev;\n\n        for (var m = 0, mLen = qavSortTriangleShape.length; m < mLen; m++) {\n            if (qavSortTriangleShape[m] !== prev) {\n                multiplierArray.push(1);\n            } else {\n                multiplierArray[multiplierArray.length - 1]++;\n            }\n            prev = qavSortTriangleShape[m];\n        }\n\n        var leadValue = qavSortTriangleShape[0];\n        var minLeadValue = -6;\n        var padding = Math.abs(minLeadValue - leadValue);\n        for (var p = 0; p < padding; p++) {\n            multiplierArray.unshift(0);\n        }\n        for (var r = 0; r < 20; r++) {\n            if (multiplierArray.length < 20) {\n                multiplierArray.push(0);\n            }\n        }\n        return multiplierArray;\n    };\n\n\n    FIREBASE.calculateSortDesignPattern = function (JsonObj, keys, sort0) {\n        var sort2, sort3, temp5;\n        var qavSortTriangleShape = [];\n        sort2 = JsonObj[keys[1]].sort;\n        sort3 = (sort0.split("|"));\n        for (var j = 0, jLen = sort3.length; j < jLen; j++) {\n            temp5 = +sort3[j];\n            qavSortTriangleShape.push(temp5);\n        }\n        qavSortTriangleShape.sort(function (a, b) {\n            return a - b;\n        });\n        return qavSortTriangleShape;\n    };\n\n    FIREBASE.pullRespondentNamesAndSortInformation = function (JsonObj, id) {\n        var temp1, sort0, sortArray, replaced, tempString1;\n        var qavRespondentNames = [];\n        var qavRespondentSortsFromDbStored = [];\n        var displaySortsArray = [];\n\n        var keys = Object.keys(JsonObj);\n        for (var i = 0, iLen = keys.length; i < iLen; i++) {\n            if (id === "ID") {\n                // create unique id from key\n                temp1 = keys[i].slice(-10);\n                qavRespondentNames.push(temp1);\n            } else {\n                temp1 = JsonObj[keys[i]][id];\n                qavRespondentNames.push(temp1);\n            }\n            sort0 = JsonObj[keys[i]].sort;\n            sortArray = "" + (sort0.split("|"));\n            var replacedDisplay2 = sortArray.split(\'+\').join(\'\');\n            var replacedQAV2 = sortArray.split(\'+\').join(\' \');\n            var replacedDisplay3 = replacedDisplay2.split(\',\').join(\',\');\n            var replacedQAV3 = replacedQAV2.split(\',\').join(\'\');\n\n            qavRespondentSortsFromDbStored.push(replacedQAV3);\n            replaced = replacedDisplay3.split(\' 0\').join(\'0\');\n            tempString1 = temp1 + "," + replaced;\n\n            displaySortsArray.push(tempString1);\n        }\n        return [displaySortsArray, qavRespondentSortsFromDbStored, keys, sort0, qavRespondentNames];\n    };\n\n\n    FIREBASE.processStatementInput = function (statementInput) {\n        var arr = statementInput.split(/\\r\\n|\\r|\\n/g);\n        // remove empty strings created by extra new line at end of pasted data\n        var array1 = arr.filter(function (e) {\n            return e;\n        });\n        return array1;\n    };\n\n\n    FIREBASE.convertToData = function (JsonObj) {\n        var csvBody = [];\n        var sortHeaders = [];\n\n        var keys = Object.keys(JsonObj);\n        var headerArray = Object.keys(JsonObj[keys[0]]);\n        var sort0 = JsonObj[keys[0]].sort;\n        var sortArray = sort0.split("|");\n\n        for (var k = 0, kLen = sortArray.length; k < kLen; k++) {\n            var counter1 = "S" + (k + 1);\n            sortHeaders.push(counter1);\n        }\n        var headerArray2 = headerArray.concat(sortHeaders);\n        // do not change to ID - will throw error when opening in MS Excel\n        headerArray2.unshift("Id");\n        csvBody.push(headerArray2);\n\n        for (var i = 0, iLen = keys.length; i < iLen; i++) {\n            var tempArray1 = [];\n            // var tempArray2 = [];\n\n            // get index\n            var temp4 = keys[i];\n            // get object\n            var arrayObj = JsonObj[temp4];\n            // get object keys\n            var arrayObjKeys = Object.keys(arrayObj);\n\n            // create unique id from key\n            var id = temp4.slice(-10);\n            tempArray1.push(id);\n            for (var m = 0, mLen = arrayObjKeys.length; m < mLen; m++) {\n                var value = arrayObj[arrayObjKeys[m]];\n                tempArray1.push(value);\n            }\n\n            // get sort of object\n            var sort1 = arrayObj.sort;\n            var sort2 = sort1.split("|");\n\n\n            for (var j = 0, jLen = sort2.length; j < jLen; j++) {\n                var temp5 = +sort2[j];\n                tempArray1.push(temp5);\n            }\n            csvBody.push(tempArray1);\n        }\n        return csvBody;\n    };\n\n    FIREBASE.downloadJsonData = function () {\n        var data = QAV.getState("JsonObj");\n        var projectName = QAV.getState("qavProjectName");\n        var csvBody = FIREBASE.convertToData(data);\n        var csvRows = [];\n\n        for (var i = 0, l = csvBody.length; i < l; ++i) {\n            for (var k = 0, kLen = csvBody[i].length; k < kLen; k++) {\n                csvBody[i][k] = UTIL.sanitizeUserInputText(csvBody[i][k]);\n            }\n            csvRows.push(csvBody[i].join(\',\'));\n        }\n        // export the file\n        UTIL.exportToCsv(projectName + \'.csv\', csvBody);\n    };\n\n}(window.FIREBASE = window.FIREBASE || {}, QAV));//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNS5qcyIsInNvdXJjZXMiOlsid2VicGFjazovLy8uL3NyYy9GSVJFQkFTRS5qcz9lNWM2Il0sInNvdXJjZXNDb250ZW50IjpbIi8vS2VuLVEgQW5hbHlzaXNcbi8vQ29weXJpZ2h0IChDKSAyMDE2IFNoYXduIEJhbmFzaWNrXG4vL1xuLy8gICAgVGhpcyBwcm9ncmFtIGlzIGZyZWUgc29mdHdhcmU6IHlvdSBjYW4gcmVkaXN0cmlidXRlIGl0IGFuZC9vciBtb2RpZnlcbi8vICAgIGl0IHVuZGVyIHRoZSB0ZXJtcyBvZiB0aGUgR05VIEdlbmVyYWwgUHVibGljIExpY2Vuc2UgYXMgcHVibGlzaGVkIGJ5XG4vLyAgICB0aGUgRnJlZSBTb2Z0d2FyZSBGb3VuZGF0aW9uLCBlaXRoZXIgdmVyc2lvbiAzIG9mIHRoZSBMaWNlbnNlLCBvclxuLy8gICAgKGF0IHlvdXIgb3B0aW9uKSBhbnkgbGF0ZXIgdmVyc2lvbi5cblxuLy8gSlNsaW50IGRlY2xhcmF0aW9uc1xuLyogZ2xvYmFsIHdpbmRvdywgUUFWLCAkLCBGaWxlUmVhZGVyLCBVVElMLCBkb2N1bWVudCAqL1xuXG4oZnVuY3Rpb24gKEZJUkVCQVNFLCBRQVYsIHVuZGVmaW5lZCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIEZJUkVCQVNFLmZpbGVQaWNrZWRKU09OID0gZnVuY3Rpb24gKGV2dCkge1xuICAgICAgICB2YXIgSnNvbk9iajtcbiAgICAgICAgdmFyIGZpbGVzID0gZXZ0LnRhcmdldC5maWxlczsgLy8gRmlsZUxpc3Qgb2JqZWN0XG4gICAgICAgIHZhciBmID0gZmlsZXNbMF07XG4gICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuXG4gICAgICAgIC8vIENsb3N1cmUgdG8gY2FwdHVyZSB0aGUgZmlsZSBpbmZvcm1hdGlvbi5cbiAgICAgICAgcmVhZGVyLm9ubG9hZCA9IChmdW5jdGlvbiAoKSB7IC8vIHRoZUZpbGVcbiAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgICAgICAgIC8vIFJlbmRlciB0aHVtYm5haWwuXG4gICAgICAgICAgICAgICAgSnNvbk9iaiA9IGUudGFyZ2V0LnJlc3VsdDtcbiAgICAgICAgICAgICAgICB2YXIganNvbk9iakZpbGUgPSBKU09OLnBhcnNlKEpzb25PYmopO1xuICAgICAgICAgICAgICAgIFFBVi5zZXRTdGF0ZShcIkpzb25PYmpcIiwganNvbk9iakZpbGUpO1xuICAgICAgICAgICAgICAgIEZJUkVCQVNFLnNldFJlc3BvbmRlbnRJZChqc29uT2JqRmlsZSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KShmKTtcbiAgICAgICAgLy8gUmVhZCBpbiB0aGUgaW1hZ2UgZmlsZSBhcyBhIGRhdGEgVVJMLlxuICAgICAgICByZWFkZXIucmVhZEFzVGV4dChmKTtcbiAgICB9O1xuXG4gICAgRklSRUJBU0Uuc2V0UmVzcG9uZGVudElkID0gZnVuY3Rpb24gKEpzb25PYmopIHtcbiAgICAgICAgJChcIi5qc29uU2VsZWN0XCIpLnNob3coKTtcbiAgICAgICAgJChcIi5kb3dubG9hZENzdkRhdGFEaXZcIikuc2hvdygpO1xuICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKEpzb25PYmopO1xuICAgICAgICB2YXIgcmVzcG9uc2VPYmplY3RLZXlzID0gT2JqZWN0LmtleXMoSnNvbk9ialtrZXlzWzBdXSk7XG4gICAgICAgIHZhciBwcm9qZWN0TmFtZSA9IEpzb25PYmpba2V5c1swXV0ubmFtZTtcbiAgICAgICAgUUFWLnNldFN0YXRlKFwicWF2UHJvamVjdE5hbWVcIiwgcHJvamVjdE5hbWUpO1xuICAgICAgICAkKFwiLmpzb25GaWxlTmFtZVwiKS5odG1sKCdcIicgKyBwcm9qZWN0TmFtZSArICdcIiBsb2FkZWQnKTtcbiAgICAgICAgJC5lYWNoKHJlc3BvbnNlT2JqZWN0S2V5cywgZnVuY3Rpb24gKGtleSwgdmFsdWUpIHtcbiAgICAgICAgICAgICQoJyNqc29uSWRTZWxlY3QnKVxuICAgICAgICAgICAgICAgIC5hcHBlbmQoJCgnPG9wdGlvbj4nLCB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZToga2V5XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIC50ZXh0KHZhbHVlKSk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBGSVJFQkFTRS5zdGFnZUpzb25EYXRhID0gZnVuY3Rpb24gKCkge1xuICAgICAgICB2YXIgYXJyLCBhcnJheTEsIGosIGssIG0sIGlkLCBKc29uT2JqLCB0ZW1wNSwga2V5cywgaSwgc29ydDAsIHRlbXAxLCB0ZW1wU3RyaW5nMSwgc29ydEFycmF5LCBpTGVuLCBtTGVuLCBrTGVuLCBzb3J0Miwgc29ydDMsIGpMZW4sIHJlcGxhY2VkLCBwcmV2LCBzdGF0ZW1lbnRJbnB1dDsgXG4gICAgICAgIHZhciBxYXZSZXNwb25kZW50TmFtZXMsIHFhdlJlc3BvbmRlbnRTb3J0c0Zyb21EYlN0b3JlZCwgcWF2U29ydFRyaWFuZ2xlU2hhcGUsIG11bHRpcGxpZXJBcnJheSwgZGlzcGxheVNvcnRzQXJyYXk7XG5cbiAgICAgICAgLy8gY2xlYXIgb3V0IGFueSBwcmV2aW91c2x5IGxvYWRlZCBkYXRhXG4gICAgICAgICQoXCIjZXhpc3RpbmdEYXRhYmFzZVN0YXRlbWVudExpc3RcIikuZW1wdHkoKTtcbiAgICAgICAgJChcIiNleGlzdGluZ0RhdGFiYXNlUmVzcG9uZGVudExpc3RcIikuZW1wdHkoKTtcblxuICAgICAgICAvLyBncmFiIHN0YXRlbWVudCBkYXRhIGZyb20gRE9NIGlucHV0XG4gICAgICAgIHN0YXRlbWVudElucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJzdGF0ZW1lbnRzSW5wdXRCb3hKc29uXCIpLnZhbHVlO1xuXG4gICAgICAgIC8vIHByb2Nlc3Mgc3RhdGVtZW50cyBmcm9tIHRleHQgdG8gZGF0YVxuICAgICAgICBhcnJheTEgPSBGSVJFQkFTRS5wcm9jZXNzU3RhdGVtZW50SW5wdXQoc3RhdGVtZW50SW5wdXQpO1xuICAgICAgICBRQVYuc2V0U3RhdGUoXCJxYXZDdXJyZW50U3RhdGVtZW50c1wiLCBhcnJheTEpO1xuICAgICAgICBRQVYuc2V0U3RhdGUoXCJxYXZPcmlnaW5hbFNvcnRTaXplXCIsIGFycmF5MS5sZW5ndGgpO1xuICAgICAgICBRQVYuc2V0U3RhdGUoXCJvcmlnaW5hbFNvcnRTaXplXCIsIGFycmF5MS5sZW5ndGgpO1xuXG4gICAgICAgIC8vIGFwcGVuZCBzdGF0ZW1lbnRzIHRvIHRoZSBET01cbiAgICAgICAgZm9yIChrID0gMCwga0xlbiA9IGFycmF5MS5sZW5ndGg7IGsgPCBrTGVuOyBrKyspIHtcbiAgICAgICAgICAgICQoXCIjZXhpc3RpbmdEYXRhYmFzZVN0YXRlbWVudExpc3RcIikuYXBwZW5kKFwiPGxpPlwiICsgYXJyYXkxW2tdICsgXCI8L2xpPlwiKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIGdyYWIgdGhlIGlkIHNlbGVjdGlvbiBmcm9tIERPTVxuICAgICAgICBpZCA9ICQoXCIjanNvbklkU2VsZWN0IDpzZWxlY3RlZFwiKS50ZXh0KCk7XG4gICAgICAgIEpzb25PYmogPSBRQVYuZ2V0U3RhdGUoXCJKc29uT2JqXCIpO1xuXG4gICAgICAgIC8vIHB1bGwgbmFtZXMgYW5kIHNvcnRzIGZyb20gSlNPTiBkYXRhXG4gICAgICAgIHZhciByZXNwb25kZW50TmFtZXNBbmRTb3J0cyA9IEZJUkVCQVNFLnB1bGxSZXNwb25kZW50TmFtZXNBbmRTb3J0SW5mb3JtYXRpb24oSnNvbk9iaiwgaWQpO1xuICAgICAgICBkaXNwbGF5U29ydHNBcnJheSA9IHJlc3BvbmRlbnROYW1lc0FuZFNvcnRzWzBdO1xuICAgICAgICBxYXZSZXNwb25kZW50U29ydHNGcm9tRGJTdG9yZWQgPSByZXNwb25kZW50TmFtZXNBbmRTb3J0c1sxXTtcbiAgICAgICAga2V5cyA9IHJlc3BvbmRlbnROYW1lc0FuZFNvcnRzWzJdO1xuICAgICAgICBzb3J0MCA9IHJlc3BvbmRlbnROYW1lc0FuZFNvcnRzWzNdO1xuICAgICAgICBxYXZSZXNwb25kZW50TmFtZXMgPSByZXNwb25kZW50TmFtZXNBbmRTb3J0c1s0XTtcblxuICAgICAgICAvLyBhcHBlbmQgc29ydHMgdG8gdGhlIERPTVxuICAgICAgICBmb3IgKHZhciBpaSA9IDAsIGlpTGVuID0gZGlzcGxheVNvcnRzQXJyYXkubGVuZ3RoOyBpaSA8IGlpTGVuOyBpaSsrKSB7XG4gICAgICAgICAgICAkKFwiI2V4aXN0aW5nRGF0YWJhc2VSZXNwb25kZW50TGlzdFwiKS5hcHBlbmQoJzxsaT4nICsgZGlzcGxheVNvcnRzQXJyYXlbaWldICsgJzxidXR0b24gY2xhc3M9XCJkZWxldGVCdXR0b25Tb3J0IHZlcnRpY2FsXCI+ZGVsZXRlIHNvcnQ8L2J1dHRvbj48L2xpPicpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gY2FsY3VsYXRlIHNvcnQgZGVzaWduIHBhdHRlcm5cbiAgICAgICAgcWF2U29ydFRyaWFuZ2xlU2hhcGUgPSBGSVJFQkFTRS5jYWxjdWxhdGVTb3J0RGVzaWduUGF0dGVybihKc29uT2JqLCBrZXlzLCBzb3J0MCk7XG5cbiAgICAgICAgLy8gY2FsY3VsYXRlIG11bHRpcGxpZXJBcnJheVxuICAgICAgICBtdWx0aXBsaWVyQXJyYXkgPSBGSVJFQkFTRS5jYWxjdWxhdGVNdWx0aXBsaWVyQXJyYXkocWF2U29ydFRyaWFuZ2xlU2hhcGUpO1xuXG4gICAgICAgIFFBVi5zZXRTdGF0ZShcIm11bHRpcGxpZXJBcnJheVwiLCBtdWx0aXBsaWVyQXJyYXkpO1xuICAgICAgICBRQVYuc2V0U3RhdGUoXCJxYXZTb3J0VHJpYW5nbGVTaGFwZVwiLCBxYXZTb3J0VHJpYW5nbGVTaGFwZSk7XG4gICAgICAgIFFBVi5zZXRTdGF0ZShcInFhdlJlc3BvbmRlbnROYW1lc1wiLCBxYXZSZXNwb25kZW50TmFtZXMpO1xuICAgICAgICBRQVYuc2V0U3RhdGUoXCJxYXZSZXNwb25kZW50U29ydHNGcm9tRGJTdG9yZWRcIiwgcWF2UmVzcG9uZGVudFNvcnRzRnJvbURiU3RvcmVkKTtcbiAgICB9O1xuXG4gICAgRklSRUJBU0UuY2FsY3VsYXRlTXVsdGlwbGllckFycmF5ID0gZnVuY3Rpb24gKHFhdlNvcnRUcmlhbmdsZVNoYXBlKSB7XG4gICAgICAgIHZhciBtdWx0aXBsaWVyQXJyYXkgPSBbXTtcbiAgICAgICAgdmFyIHByZXY7XG5cbiAgICAgICAgZm9yICh2YXIgbSA9IDAsIG1MZW4gPSBxYXZTb3J0VHJpYW5nbGVTaGFwZS5sZW5ndGg7IG0gPCBtTGVuOyBtKyspIHtcbiAgICAgICAgICAgIGlmIChxYXZTb3J0VHJpYW5nbGVTaGFwZVttXSAhPT0gcHJldikge1xuICAgICAgICAgICAgICAgIG11bHRpcGxpZXJBcnJheS5wdXNoKDEpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBtdWx0aXBsaWVyQXJyYXlbbXVsdGlwbGllckFycmF5Lmxlbmd0aCAtIDFdKys7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBwcmV2ID0gcWF2U29ydFRyaWFuZ2xlU2hhcGVbbV07XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgbGVhZFZhbHVlID0gcWF2U29ydFRyaWFuZ2xlU2hhcGVbMF07XG4gICAgICAgIHZhciBtaW5MZWFkVmFsdWUgPSAtNjtcbiAgICAgICAgdmFyIHBhZGRpbmcgPSBNYXRoLmFicyhtaW5MZWFkVmFsdWUgLSBsZWFkVmFsdWUpO1xuICAgICAgICBmb3IgKHZhciBwID0gMDsgcCA8IHBhZGRpbmc7IHArKykge1xuICAgICAgICAgICAgbXVsdGlwbGllckFycmF5LnVuc2hpZnQoMCk7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICh2YXIgciA9IDA7IHIgPCAyMDsgcisrKSB7XG4gICAgICAgICAgICBpZiAobXVsdGlwbGllckFycmF5Lmxlbmd0aCA8IDIwKSB7XG4gICAgICAgICAgICAgICAgbXVsdGlwbGllckFycmF5LnB1c2goMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG11bHRpcGxpZXJBcnJheTtcbiAgICB9O1xuXG5cbiAgICBGSVJFQkFTRS5jYWxjdWxhdGVTb3J0RGVzaWduUGF0dGVybiA9IGZ1bmN0aW9uIChKc29uT2JqLCBrZXlzLCBzb3J0MCkge1xuICAgICAgICB2YXIgc29ydDIsIHNvcnQzLCB0ZW1wNTtcbiAgICAgICAgdmFyIHFhdlNvcnRUcmlhbmdsZVNoYXBlID0gW107XG4gICAgICAgIHNvcnQyID0gSnNvbk9ialtrZXlzWzFdXS5zb3J0O1xuICAgICAgICBzb3J0MyA9IChzb3J0MC5zcGxpdChcInxcIikpO1xuICAgICAgICBmb3IgKHZhciBqID0gMCwgakxlbiA9IHNvcnQzLmxlbmd0aDsgaiA8IGpMZW47IGorKykge1xuICAgICAgICAgICAgdGVtcDUgPSArc29ydDNbal07XG4gICAgICAgICAgICBxYXZTb3J0VHJpYW5nbGVTaGFwZS5wdXNoKHRlbXA1KTtcbiAgICAgICAgfVxuICAgICAgICBxYXZTb3J0VHJpYW5nbGVTaGFwZS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICByZXR1cm4gYSAtIGI7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcWF2U29ydFRyaWFuZ2xlU2hhcGU7XG4gICAgfTtcblxuICAgIEZJUkVCQVNFLnB1bGxSZXNwb25kZW50TmFtZXNBbmRTb3J0SW5mb3JtYXRpb24gPSBmdW5jdGlvbiAoSnNvbk9iaiwgaWQpIHtcbiAgICAgICAgdmFyIHRlbXAxLCBzb3J0MCwgc29ydEFycmF5LCByZXBsYWNlZCwgdGVtcFN0cmluZzE7XG4gICAgICAgIHZhciBxYXZSZXNwb25kZW50TmFtZXMgPSBbXTtcbiAgICAgICAgdmFyIHFhdlJlc3BvbmRlbnRTb3J0c0Zyb21EYlN0b3JlZCA9IFtdO1xuICAgICAgICB2YXIgZGlzcGxheVNvcnRzQXJyYXkgPSBbXTtcblxuICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKEpzb25PYmopO1xuICAgICAgICBmb3IgKHZhciBpID0gMCwgaUxlbiA9IGtleXMubGVuZ3RoOyBpIDwgaUxlbjsgaSsrKSB7XG4gICAgICAgICAgICBpZiAoaWQgPT09IFwiSURcIikge1xuICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSB1bmlxdWUgaWQgZnJvbSBrZXlcbiAgICAgICAgICAgICAgICB0ZW1wMSA9IGtleXNbaV0uc2xpY2UoLTEwKTtcbiAgICAgICAgICAgICAgICBxYXZSZXNwb25kZW50TmFtZXMucHVzaCh0ZW1wMSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRlbXAxID0gSnNvbk9ialtrZXlzW2ldXVtpZF07XG4gICAgICAgICAgICAgICAgcWF2UmVzcG9uZGVudE5hbWVzLnB1c2godGVtcDEpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgc29ydDAgPSBKc29uT2JqW2tleXNbaV1dLnNvcnQ7XG4gICAgICAgICAgICBzb3J0QXJyYXkgPSBcIlwiICsgKHNvcnQwLnNwbGl0KFwifFwiKSk7XG4gICAgICAgICAgICB2YXIgcmVwbGFjZWREaXNwbGF5MiA9IHNvcnRBcnJheS5zcGxpdCgnKycpLmpvaW4oJycpO1xuICAgICAgICAgICAgdmFyIHJlcGxhY2VkUUFWMiA9IHNvcnRBcnJheS5zcGxpdCgnKycpLmpvaW4oJyAnKTtcbiAgICAgICAgICAgIHZhciByZXBsYWNlZERpc3BsYXkzID0gcmVwbGFjZWREaXNwbGF5Mi5zcGxpdCgnLCcpLmpvaW4oJywnKTtcbiAgICAgICAgICAgIHZhciByZXBsYWNlZFFBVjMgPSByZXBsYWNlZFFBVjIuc3BsaXQoJywnKS5qb2luKCcnKTtcblxuICAgICAgICAgICAgcWF2UmVzcG9uZGVudFNvcnRzRnJvbURiU3RvcmVkLnB1c2gocmVwbGFjZWRRQVYzKTtcbiAgICAgICAgICAgIHJlcGxhY2VkID0gcmVwbGFjZWREaXNwbGF5My5zcGxpdCgnIDAnKS5qb2luKCcwJyk7XG4gICAgICAgICAgICB0ZW1wU3RyaW5nMSA9IHRlbXAxICsgXCIsXCIgKyByZXBsYWNlZDtcblxuICAgICAgICAgICAgZGlzcGxheVNvcnRzQXJyYXkucHVzaCh0ZW1wU3RyaW5nMSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFtkaXNwbGF5U29ydHNBcnJheSwgcWF2UmVzcG9uZGVudFNvcnRzRnJvbURiU3RvcmVkLCBrZXlzLCBzb3J0MCwgcWF2UmVzcG9uZGVudE5hbWVzXTtcbiAgICB9O1xuXG5cbiAgICBGSVJFQkFTRS5wcm9jZXNzU3RhdGVtZW50SW5wdXQgPSBmdW5jdGlvbiAoc3RhdGVtZW50SW5wdXQpIHtcbiAgICAgICAgdmFyIGFyciA9IHN0YXRlbWVudElucHV0LnNwbGl0KC9cXHJcXG58XFxyfFxcbi9nKTtcbiAgICAgICAgLy8gcmVtb3ZlIGVtcHR5IHN0cmluZ3MgY3JlYXRlZCBieSBleHRyYSBuZXcgbGluZSBhdCBlbmQgb2YgcGFzdGVkIGRhdGFcbiAgICAgICAgdmFyIGFycmF5MSA9IGFyci5maWx0ZXIoZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgIHJldHVybiBlO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGFycmF5MTtcbiAgICB9O1xuXG5cbiAgICBGSVJFQkFTRS5jb252ZXJ0VG9EYXRhID0gZnVuY3Rpb24gKEpzb25PYmopIHtcbiAgICAgICAgdmFyIGNzdkJvZHkgPSBbXTtcbiAgICAgICAgdmFyIHNvcnRIZWFkZXJzID0gW107XG5cbiAgICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyhKc29uT2JqKTtcbiAgICAgICAgdmFyIGhlYWRlckFycmF5ID0gT2JqZWN0LmtleXMoSnNvbk9ialtrZXlzWzBdXSk7XG4gICAgICAgIHZhciBzb3J0MCA9IEpzb25PYmpba2V5c1swXV0uc29ydDtcbiAgICAgICAgdmFyIHNvcnRBcnJheSA9IHNvcnQwLnNwbGl0KFwifFwiKTtcblxuICAgICAgICBmb3IgKHZhciBrID0gMCwga0xlbiA9IHNvcnRBcnJheS5sZW5ndGg7IGsgPCBrTGVuOyBrKyspIHtcbiAgICAgICAgICAgIHZhciBjb3VudGVyMSA9IFwiU1wiICsgKGsgKyAxKTtcbiAgICAgICAgICAgIHNvcnRIZWFkZXJzLnB1c2goY291bnRlcjEpO1xuICAgICAgICB9XG4gICAgICAgIHZhciBoZWFkZXJBcnJheTIgPSBoZWFkZXJBcnJheS5jb25jYXQoc29ydEhlYWRlcnMpO1xuICAgICAgICAvLyBkbyBub3QgY2hhbmdlIHRvIElEIC0gd2lsbCB0aHJvdyBlcnJvciB3aGVuIG9wZW5pbmcgaW4gTVMgRXhjZWxcbiAgICAgICAgaGVhZGVyQXJyYXkyLnVuc2hpZnQoXCJJZFwiKTtcbiAgICAgICAgY3N2Qm9keS5wdXNoKGhlYWRlckFycmF5Mik7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIGlMZW4gPSBrZXlzLmxlbmd0aDsgaSA8IGlMZW47IGkrKykge1xuICAgICAgICAgICAgdmFyIHRlbXBBcnJheTEgPSBbXTtcbiAgICAgICAgICAgIC8vIHZhciB0ZW1wQXJyYXkyID0gW107XG5cbiAgICAgICAgICAgIC8vIGdldCBpbmRleFxuICAgICAgICAgICAgdmFyIHRlbXA0ID0ga2V5c1tpXTtcbiAgICAgICAgICAgIC8vIGdldCBvYmplY3RcbiAgICAgICAgICAgIHZhciBhcnJheU9iaiA9IEpzb25PYmpbdGVtcDRdO1xuICAgICAgICAgICAgLy8gZ2V0IG9iamVjdCBrZXlzXG4gICAgICAgICAgICB2YXIgYXJyYXlPYmpLZXlzID0gT2JqZWN0LmtleXMoYXJyYXlPYmopO1xuXG4gICAgICAgICAgICAvLyBjcmVhdGUgdW5pcXVlIGlkIGZyb20ga2V5XG4gICAgICAgICAgICB2YXIgaWQgPSB0ZW1wNC5zbGljZSgtMTApO1xuICAgICAgICAgICAgdGVtcEFycmF5MS5wdXNoKGlkKTtcbiAgICAgICAgICAgIGZvciAodmFyIG0gPSAwLCBtTGVuID0gYXJyYXlPYmpLZXlzLmxlbmd0aDsgbSA8IG1MZW47IG0rKykge1xuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGFycmF5T2JqW2FycmF5T2JqS2V5c1ttXV07XG4gICAgICAgICAgICAgICAgdGVtcEFycmF5MS5wdXNoKHZhbHVlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gZ2V0IHNvcnQgb2Ygb2JqZWN0XG4gICAgICAgICAgICB2YXIgc29ydDEgPSBhcnJheU9iai5zb3J0O1xuICAgICAgICAgICAgdmFyIHNvcnQyID0gc29ydDEuc3BsaXQoXCJ8XCIpO1xuXG5cbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwLCBqTGVuID0gc29ydDIubGVuZ3RoOyBqIDwgakxlbjsgaisrKSB7XG4gICAgICAgICAgICAgICAgdmFyIHRlbXA1ID0gK3NvcnQyW2pdO1xuICAgICAgICAgICAgICAgIHRlbXBBcnJheTEucHVzaCh0ZW1wNSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjc3ZCb2R5LnB1c2godGVtcEFycmF5MSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNzdkJvZHk7XG4gICAgfTtcblxuICAgIEZJUkVCQVNFLmRvd25sb2FkSnNvbkRhdGEgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHZhciBkYXRhID0gUUFWLmdldFN0YXRlKFwiSnNvbk9ialwiKTtcbiAgICAgICAgdmFyIHByb2plY3ROYW1lID0gUUFWLmdldFN0YXRlKFwicWF2UHJvamVjdE5hbWVcIik7XG4gICAgICAgIHZhciBjc3ZCb2R5ID0gRklSRUJBU0UuY29udmVydFRvRGF0YShkYXRhKTtcbiAgICAgICAgdmFyIGNzdlJvd3MgPSBbXTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGNzdkJvZHkubGVuZ3RoOyBpIDwgbDsgKytpKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBrID0gMCwga0xlbiA9IGNzdkJvZHlbaV0ubGVuZ3RoOyBrIDwga0xlbjsgaysrKSB7XG4gICAgICAgICAgICAgICAgY3N2Qm9keVtpXVtrXSA9IFVUSUwuc2FuaXRpemVVc2VySW5wdXRUZXh0KGNzdkJvZHlbaV1ba10pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY3N2Um93cy5wdXNoKGNzdkJvZHlbaV0uam9pbignLCcpKTtcbiAgICAgICAgfVxuICAgICAgICAvLyBleHBvcnQgdGhlIGZpbGVcbiAgICAgICAgVVRJTC5leHBvcnRUb0Nzdihwcm9qZWN0TmFtZSArICcuY3N2JywgY3N2Qm9keSk7XG4gICAgfTtcblxufSh3aW5kb3cuRklSRUJBU0UgPSB3aW5kb3cuRklSRUJBU0UgfHwge30sIFFBVikpO1xuXG5cbi8vLy8vLy8vLy8vLy8vLy8vL1xuLy8gV0VCUEFDSyBGT09URVJcbi8vIC4vc3JjL0ZJUkVCQVNFLmpzXG4vLyBtb2R1bGUgaWQgPSA1XG4vLyBtb2R1bGUgY2h1bmtzID0gMTIiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlUm9vdCI6IiJ9')}});