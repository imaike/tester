!function(e){function t(o){if(r[o])return r[o].exports;var n=r[o]={i:o,l:!1,exports:{}};return e[o].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var r={};t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,o){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=2)}({2:function(e,t){!function(e,t,r){"use strict";function o(e){var t=e[0];e.shift();for(var r=0,o=e.length;r<o;r++)e[r].unshift(r+1);for(var n,a=[],s=0,l=t.length;s<l;s++)n={},n.title=t[s],a.push(n);var i=a.shift(),c={title:"Respon."};a.unshift(c),a.unshift(i);for(var u=[],d=2,f=t.length+1;d<f;d++)u.push(d);$("#correlationTable2").DataTable({fixedColumns:{leftColumns:2},retrieve:!0,searching:!1,ordering:!0,info:!1,destroy:!0,scrollY:800,scrollCollapse:!0,scrollX:!0,paging:!1,data:e,columns:a,columnDefs:[{targets:u,className:"dt-head-center dt-body-right"},{targets:[0,1],className:"dt-body-center dt-body-name"},{targets:"_all",createdCell:function(e,t){t<0&&$(e).css("color","red")}}]});var v=$("#correlationTable2").DataTable();$("#correlationTable2 tbody").on("mouseenter","td",function(){var e=v.cell(this).index().column;$(v.cells().nodes()).removeClass("highlight"),$(v.column(e).nodes()).addClass("highlight")}).on("mouseleave",function(){$(v.cells().nodes()).removeClass("highlight"),$(v.columns().nodes()).removeClass("highlight")})}e.createCorrelationTable=function(){var r,n,a=performance.now(),s=t.getState("qavRespondentNames"),l=UTIL.checkUniqueName(s);t.setState("qavRespondentNames",l),t.setState("respondentNames",l),t.setState("qavTotalNumberSorts",l.length),t.setState("totalNumberSorts",l.length);var i=t.getState("qavOriginalSortSize"),c=t.getState("qavRespondentSortsFromDbStored"),u=UTIL.checkIfOnline();if(window.Worker&&u){$("#correlationSpinnerText").css("visibility","visible"),$("#correlationSpinnerDiv").addClass("calcSpinner");var d=new Worker("wrkrs/workerCorr.js"),f=[i,c,l];d.postMessage(f),d.onmessage=function(e){t.setState("sortsAsNumbers",e.data[0]),t.setState("positiveShiftedRawSorts",e.data[1]),t.setState("correlationTableArrayFormatted",e.data[2]),t.setState("respondentNames",e.data[3]),t.setState("originalCorrelationValues",e.data[4]),$("#correlationSpinnerText").css("visibility","hidden"),$("#correlationSpinnerDiv").removeClass("calcSpinner"),o(e.data[2]),r=performance.now(),console.log("%c Correlation Table completed in "+(r-a).toFixed(0)+" milliseconds","background: black; color: white")}}else l.length>0&&$("#correlationsSpinner").append('<p id="spinnerText">&nbsp&nbsp Calculating, <i>please wait</i>&nbsp&nbsp</p>').fadeIn(300),$("#calculatingCorrelationsModal").toggleClass("active"),setTimeout(function(){var t=e.convertSortsTextToNumbers(c,i);n=e.calculateCorrelations(t,l),$("#correlationsSpinner").children("p").remove(),o(n),r=performance.now(),console.log("%c Correlation Table completed in "+(r-a).toFixed(0)+" milliseconds","background: black; color: white")},10)},e.convertSortsTextToNumbers=function(e,r){console.time("convertNumbers");var o,n=[];!1===_.isArray(e[0])?_(e).forEach(function(e){var t,o,a,s=0,l=2,i=[],c=r;for(t=0;t<c;t++)o=e.slice(s,l),a=+o,i.push(a),s+=2,l+=2;n.push(i)}).value():n=_.cloneDeep(e),t.setState("sortsAsNumbers",n);var a=_.cloneDeep(n);return o=_.max(a[0]),_(a).forEach(function(e){var t,n=r;for(t=0;t<n;t++)e[t]=e[t]+o+1}).value(),t.setState("positiveShiftedRawSorts",a),console.timeEnd("convertNumbers"),n},e.getPqmethodCorrelation=function(e,t){/**
         *  @fileoverview Pearson correlation score algorithm.
         *  @author matt.west@kojilabs.com (Matt West)
         *  @license Copyright 2013 Matt West.
         *  Licensed under MIT (http://opensource.org/licenses/MIT).
         */
var r=e.length;if(0===r)return 0;for(var o=0,n=0;n<r;n++)o+=e[n];for(var a=0,s=0;s<r;s++)a+=t[s];for(var l=0,i=0;i<r;i++)l+=Math.pow(e[i],2);for(var c=0,u=0;u<r;u++)c+=Math.pow(t[u],2);for(var d=0,f=0;f<r;f++)d+=e[f]*t[f];var v=d-o*a/r,p=Math.sqrt((l-Math.pow(o,2)/r)*(c-Math.pow(a,2)/r));if(0===p)return 0;var h=v/p;return[evenRound(h,5),evenRound(100*h,0)]},e.calculateCorrelations=function(r,o){console.time("correlation calculations and table display ");for(var n=o.length,a=_.cloneDeep(r),s=[],l=[],i=0;i<n;i++)s[i]=[];for(var c=0;c<n;c++)l[c]=[];for(var u=0;u<n;u++){var d=a[u],f=e.getPqmethodCorrelation(a[u],a[u]);s[0][0]=f[0],l[0][0]=f[1];for(var v=u;v<n;v++){var p=e.getPqmethodCorrelation(d,a[v]);s[u][v]=p[0],l[u][v]=p[1],v===u||(s[v][u]=p[0],l[v][u]=p[1])}}for(var h=0;h<n;h++){var m=o[h];l[h].unshift(m)}return o.unshift(""),l.unshift(o),t.setState("correlationTableArrayFormatted",l),t.setState("respondentNames",o),t.setState("originalCorrelationValues",s),console.timeEnd("correlation calculations and table display "),l}}(window.CORR=window.CORR||{},QAV)}});