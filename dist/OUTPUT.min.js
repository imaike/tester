!function(t){function e(a){if(r[a])return r[a].exports;var s=r[a]={i:a,l:!1,exports:{}};return t[a].call(s.exports,s,s.exports,e),s.l=!0,s.exports}var r={};e.m=t,e.c=r,e.i=function(t){return t},e.d=function(t,r,a){e.o(t,r)||Object.defineProperty(t,r,{configurable:!1,enumerable:!0,get:a})},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=8)}({8:function(t,e){!function(t,e,r){"use strict";function a(t,r,a,n,o){var u=e.getState("qavCurrentStatements"),h=e.getState("language"),c=resources[h].translation.Statements,i=resources[h].translation["Statement Number"];n.push(c);var l=0,p=[];p.push(["",""],[i,c]);for(var S=0,g=u.length;S<g;S++){var v=[];v.push(S+1,u[S]),p.push(v);var f=u[S].length;f>l&&(l=f)}a.push(p);var m=[{wch:10},{wch:l}];o.push(m),e.setState("maxStatementLength",l),s(t,r,a,n,o)}function s(t,r,a,s,o){var u=e.getState("language"),h=resources[u].translation.Respondent,c=resources[u].translation.Mean,i=resources[u].translation["Standard Deviation"],l=resources[u].translation["Q-sorts"];s.push(l);for(var p=e.getState("sortsAsNumbers"),S=e.getState("qavRespondentNames"),g=[],v=[{wch:15}],f=0,m=p[0].length+2;f<m;f++)v.push({wch:5});o.push(v);for(var d,w,N=[h],y=0,F=p[0].length;y<F;y++)w="S"+(y+1),N.push(w);N.push(c,i),g.push(["",""],[l,""],["",""],N);for(var b=0,A=p.length;b<A;b++){var R=evenRound(UTIL.average(p[b]),3);d=evenRound(UTIL.standardDeviation(p[b]),3),p[b].unshift(S[b]),p[b].push(R,d),g.push(p[b])}a.push(g),e.setState("freeDistributionArray",g),n(t,r,a,s,o)}function n(t,r,a,s,n){var u=e.getState("language"),h=resources[u].translation["Correlation matrix"],c=resources[u].translation["between Q-sorts"];s.push(h);for(var i=e.getState("correlationTableArrayFormatted"),l=0,p=0,S=i[0].length;p<S;p++){var g=i[0][p].length;g>l&&(l=g)}l<5&&(l=5);for(var v=[],f=0,m=i[0].length+1;f<m;f++)v.push({wch:l});n.push(v),i.unshift(["",""],[h+c],["",""]),a.push(i),o(t,r,a,s,n)}function o(t,r,a,s,n){var o,h,c,i,l,p,S,g,v,f=e.getState("language"),m=resources[f].translation["Unrotated Factor Matrix"],d=resources[f].translation.Eigenvalues,w=(resources[f].translation.Factor,resources[f].translation.Respondent);S=e.respondentNames,o=e.getState("eigenVecs"),c=e.getState("eigenValuesSorted"),l=e.getState("eigenValuesAsPercents"),i=e.getState("factorLabels"),p=e.getState("expVarCentroid"),v=e.getState("numFactorsExtracted"),g=e.getState("typeOfFactor"),s.push(m);var N=[{wch:20}],y=0;for(i.length;y<A;y++)N.push({wch:8});if(n.push(N),"PCA"===g){for(l=l.slice(0,v),c=c.slice(0,v),h=0;h<S.length-1;h++)o[h].unshift(S[h+1]);i.unshift(""),o.unshift(i),c.unshift(d),o.push([],c),l.unshift(""),o.push(l)}else o=e.getState("factorMatrixTransposed"),o.push(p);var F=_.cloneDeep(o);F[0][0]=w;for(var b=1,A=F.length-1;b<A;b++)for(var R=1,C=F[b].length;R<C;R++)F[b][R]=evenRound(F[b][R],4);F.unshift(["",""],[m],["",""]),a.push(F),u(t,r,o,a,s,n)}function u(t,r,a,s,n,o){var u,c,i,l,p,S,g,v,f=e.getState("language"),m=resources[f].translation["Cumul Comm Matrix"],d=resources[f].translation["cumulative % explained variance"],w=resources[f].translation.Respondent,N=resources[f].translation["Cumulative Communalities Matrix"];n.push(m),u=_.cloneDeep(a);for(var y=[{wch:30}],F=0,b=u[0].length;F<b;F++)y.push({wch:8});for(o.push(y),c=u.pop(),u.pop(),i=u.shift(),l=0;l<u.length;l++){for(v=u[l].shift(),p=0;p<u[l].length;p++)0===p?(g=u[l][p],u[l][p]=evenRound(g*g,4)):(g=u[l][p],u[l][p]=evenRound(g*g+u[l][p-1],4));u[l].unshift(v)}for(u.unshift(i),c.shift(),S=0;S<c.length;S++)0===S||(c[S],c[S]=c[S]+c[S-1]);c.unshift(d),u.push(c),r.push(u),u[0][0]=w,u.unshift(["",""],[N],["",""]),s.push(u),h(t,r,s,n,o)}function h(t,r,a,s,n){var o=e.getState("results"),u=e.getState("language"),h=resources[u].translation.Loadings,i=resources[u].translation.Flagged,l=resources[u].translation["Factor Matrix with Defining Sorts Flagged"];s.push(h);var p,S,g,v=[],f=o[0].length,m=o.length,d=[],w=$("#factorRotationTable2 thead tr")[0];for($.each(w.cells,function(t,e){var r=e.textContent;d.push(r)}),v.push(d),o.sort(function(t,e){return t[0]-e[0]}),p=0;p<m;p++){for(S=0;S<f;S++)g=o[p][S],"true"===g?o[p][S]=i:"false"===g?o[p][S]="":0===S||isNaN(g)||(o[p][S]=evenRound(g,4));v.push(o[p])}var N=e.getState("expVar");v.push(N);for(var y=[{wch:20}],F=0,b=v[0].length;F<b;F++)y.push({wch:8});n.push(y),r.push(v),v.unshift(["",""],[l],["",""]),a.push(v),c(t,r,a,s,n)}function c(t,r,a,s,n){var o=e.getState("language"),u=resources[o].translation["Free Dist"],h=(resources[o].translation.Respondent,resources[o].translation.Mean,resources[o].translation["Standard Deviation"],resources[o].translation["Free Distribution Data Results"]),c=(e.getState("qavCurrentStatements"),{sheetid:u,headers:!1});t.push(c),s.push(u);var l=[{wch:20},{wch:10},{wch:10}];n.push(l);var p=e.getState("freeDistributionArray");p=p.slice(3);for(var S=[],g=p[0].length-3,v=0,f=p.length;v<f;v++){p[v].splice(1,g);S.push(p[v])}S.unshift(["",""],[h],["",""]),a.push(S),i(t,r,a,s,n)}function i(t,r,a,s,n){for(var o=e.getState("language"),u=resources[o].translation["Sorts Weight"],h=resources[o].translation["Sorts Corr"],c=resources[o].translation["Statement Number"],i=resources[o].translation.Statement,p=resources[o].translation["Z-score"],S=resources[o].translation["Sort Values"],g=e.getState("analysisOutput"),v=_.cloneDeep(g),f=e.getState("sigSortsArray"),m=e.getState("sortsAsNumbers"),d=e.getState("qavRespondentNames"),w=e.getState("correlationTableArrayFormatted"),N=e.getState("userSelectedFactors"),y=e.getState("sortWeights"),F=[],b=[],A=[],R=[],C=[],V=[],x=[],D=0;D<v.length;D++){var T={},z={},L={};z.sheetid=f[D]["Factor Number"]+u,z.header=!0,C.push(z),L.sheetid=f[D]["Factor Number"]+h,L.header=!0,V.push(L),T.sheetid=f[D]["Factor Number"],T.header=!0,x.push(T)}e.setState("sheetNamesHolder1",C),e.setState("sheetNamesHolder2",V),e.setState("sheetNamesHolder3",x);for(var k=[],Z=0;Z<f.length;Z++){for(var I=[],Q=0;Q<f[Z].SigSorts.length;Q++){var P=f[Z].SigSorts[Q],H=d.indexOf(P),O=m[H];I.push(O)}k.push(I)}for(var U=[],q=[],M=0;M<v.length;M++){for(var X=[["Q-Sort","Weight"]],G=N[M],j=0;j<y.length;j++){var B=[];y[j][0]===G&&(B.push(y[j][1],y[j][3]),X.push(B))}F.push(X);for(var E=N[M],W=[],K=0;K<f.length;K++)f[K]["Factor Number"]===E&&W.push(f[K].SigSorts);for(var $=[],Y=["Q-Sort"],J=w[0],tt=0;tt<W[0].length;tt++){Y.push(W[0][tt]);for(var et=0;et<w.length;et++){var rt=[];if(w[et][0]===W[0][tt]){rt.push(W[0][tt]);for(var at=0;at<W[0].length;at++){var st=J.indexOf(W[0][at]);rt.push(w[et][st])}$.push(rt)}}}$.unshift(Y),b.push($);for(var nt=[],ot=[],ut=[],ht=0,ct=v[0].length;ht<ct;ht++){var it={},lt={},pt=0,St=[];lt.indexer=v[M][ht].statement,lt.matchSortValue=v[M][ht].sortValue,lt.zScore=v[M][ht].zScore;var gt=v[M][ht].sortValue;it[c]=v[M][ht].statement,it[i]=v[M][ht].sortStatement,it[p]=v[M][ht].zScore,it[S]=v[M][ht].sortValue,St.push(v[M][ht].statement,v[M][ht].sortStatement,v[M][ht].zScore,v[M][ht].sortValue);for(var vt=0,ft=k[M].length;vt<ft;vt++)it["Raw Sort "+f[M].SigSorts[vt]]=k[M][vt][ht],St.push(k[M][vt][ht]),gt===k[M][vt][ht]&&pt++;lt.matchingCounts=pt,lt.matchingCountsPercent=parseInt(pt/ft*100,10),ot.push(lt),nt.push(it),ut.push(St)}U.push(ut),q.push(ot),R=nt.slice(0),R.sort(function(t,e){return e[p]===t[p]?e[c]-t[c]:e[p]-t[p]}),A.push(R)}e.setState("factorWeightFactorArrayHolder",F),e.setState("miniCorrelationArrayHolder",b),e.setState("synFactorArray1Holder",A),e.setState("matchCount",q),e.setState("compositeFactorMasterArray",U),l(t,r,a,s,n)}function l(t,r,a,s,n){var o,u,h,c=e.getState("language"),i=resources[c].translation["Factor Score Ranks"],l=(resources[c].translation.Factors,resources[c].translation["Statement Number"]),S=resources[c].translation.Statement,g=resources[c].translation["Z-score"],v=resources[c].translation["Factor Scores with Corresponding Ranks"],f=resources[c].translation.Rank,m=resources[c].translation["Sort Values"],d=e.getState("synFactorArray1Holder"),w=e.getState("userSelectedFactors"),N=[];s.push(i);for(var y=e.getState("maxStatementLength"),F=[{wch:8},{wch:y},{wch:8}],b=0,A=2*w.length;b<A;b++)F.push({wch:7});n.push(F);for(var R=0,C=d.length;R<C;R++){for(var V=0,_=d[R].length;V<_;V++)d[R][V][g]=evenRound(d[R][V][g],2);d[R].sort(function(t,e){return e[g]===t[g]?t[l]-e[l]:e[g]-t[g]});for(var x=0,D=d[R].length;x<D;x++)u=x+1,d[R][x].Rank=u;d[R].sort(function(t,e){return t[l]-e[l]})}var T=e.getState("compositeFactorMasterArray"),z=[];T[0].sort(function(t,e){return t[0]===e[0]?0:t[0]<e[0]?-1:1});for(var L=0,k=T[0].length;L<k;L++){var Z=[];Z.push(T[0][L][0]),Z.push(T[0][L][1]),Z.push(T[0][L][0]),z.push(Z)}for(var I=0,Q=T.length;I<Q;I++){T[I].sort(function(t,e){return t[0]===e[0]?0:t[0]<e[0]?-1:1});for(var P=0,H=T[I].length;P<H;P++){var O=evenRound(T[I][P][2],2);z[P].push(O)}T[I].sort(function(t,e){return t[2]===e[2]?0:e[2]<t[2]?-1:1});for(var U=0,q=T[I].length;U<q;U++){var M=U+1;T[I][U].push(M)}T[I].sort(function(t,e){return t[0]===e[0]?0:t[0]<e[0]?-1:1});for(var X=0,G=T[I].length;X<G;X++){var j=T[I][X].pop();z[X].push(j)}}for(var B=["",""],E=["",v],W=[l,S,l],K=["","",""],$=0,Y=w.length;$<Y;$++)W.push(w[$],w[$]),K.push("Z-score","Rank");z.unshift(B,E,B,W,K),a.push(z);for(var J=[],tt=0,et=d[0].length;tt<et;tt++){h=[],o={},o.Num1=d[0][tt][l],o.Statement=d[0][tt][S],o.Num2=d[0][tt][l],o.Zscore1=d[0][tt][g];var rt=d[0][tt][f];o.Rank1=rt;var at=d[0][tt][m];h.push(at);for(var st=1,nt=d.length;st<nt;st++){var ot=st+1;o["Zscore"+ot]=d[st][tt][g],o["Rank"+ot]=d[st][tt][f];var ut=d[st][tt][m];h.push(ut)}J.push(o),N.push(h)}e.setState("statementRankingArray",N),p(t,r,a,s,n)}function p(t,r,a,s,n){function o(t){return evenRound(t,5)}var u=e.getState("language"),h=resources[u].translation["Factor score correlations"];s.push(h);for(var c,i,l=e.getState("analysisOutput"),p=e.getState("userSelectedFactors"),g=_.cloneDeep(l),v=[],f=[{wch:7}],m=0,d=p.length;m<d;m++)f.push({wch:7});n.push(f);for(var w=0;w<p.length;w++){p[w],i=[];for(var N=0;N<g[w].length;N++)c=g[w][N].zScore,i.push(c);v.push(i)}for(var y=[],F=0;F<v.length;F++){var b=_.map(v[F],o);y.push(b)}for(var A,R=[],C=[],V=0;V<y.length;V++)A=y[V],R=function(t,e){var r,a,s=[];return _(t).forEach(function(t){a=CORR.getPqmethodCorrelation(e,t),r=evenRound(a[0],4),s.push(r)}).value(),s}(y,A),C.push(R),R=[];for(var x=0;x<C.length;x++){var D=p[x];C[x].unshift(D)}var T=[];T.push("");for(var z=0;z<p.length;z++){var L=p[z];T.push(L)}C.unshift(T),e.setState("correlationTableArrayHolder",C),r.push(C),C.unshift(["",""],[h],["",""]),a.push(C),S(t,r,l,a,s,n)}function S(t,r,a,s,n,o){for(var u=e.getState("language"),h=resources[u].translation["Sorts Weight"],c=(resources[u].translation["Sorts Corr"],resources[u].translation["Statement Number"]),i=resources[u].translation.Statement,l=resources[u].translation["Z-score"],p=resources[u].translation["Raw Sort"],S=resources[u].translation["Sort Values"],v=resources[u].translation["Sorts Correlations"],f=resources[u].translation["Factor Scores for "],m=e.getState("sheetNamesHolder1"),d=e.getState("sheetNamesHolder2"),w=e.getState("sheetNamesHolder3"),N=e.getState("factorWeightFactorArrayHolder"),y=e.getState("miniCorrelationArrayHolder"),F=e.getState("synFactorArray1Holder"),b=e.getState("compositeFactorMasterArray"),A=e.getState("userSelectedFactors"),R=e.getState("sigSortsArray"),C=e.getState("maxStatementLength"),V=["",""],_=0,x=A.length;_<x;_++){var D=[c,i,l,S];n.push(m[_].sheetid);var T=[{wch:8},{wch:8}];o.push(T),N[_].unshift(V,[A[_],h],V),s.push(N[_]),n.push(d[_].sheetid);for(var z=[{wch:8}],L=0,k=A.length;L<k;L++)z.push({wch:8});o.push(z),y[_].unshift(V,[A[_],v],V),s.push(y[_]),n.push(w[_].sheetid);for(var Z=[{wch:8},{wch:C},{wch:9},{wch:12}],I=0,Q=R[_].SigSorts.length;I<Q;I++)Z.push({wch:12});o.push(Z),b[_].sort(function(t,e){return t[2]===e[2]?t[0]<e[0]?-1:1:e[2]<t[2]?-1:1});for(var P=0,H=R[_].SigSorts.length;P<H;P++)D.push(p+" "+R[_].SigSorts[P]);b[_].unshift(V,["",f+" "+A[_]],V,D),s.push(b[_])}for(var O=0,U=N.length;O<U;O++)t.push(m[O]),t.push(d[O]),t.push(w[O]),r.push(N[O]),r.push(y[O]),r.push(F[O]);g(t,r,a,s,n,o)}function g(t,r,a,s,n,o){for(var u,h,c=e.getState("language"),i=resources[c].translation.Diff,l=resources[c].translation.Difference,p=resources[c].translation["Statement Number"],S=resources[c].translation.Statement,g=resources[c].translation["Descending Array of Differences Between"],f=resources[c].translation.and,m=e.getState("maxStatementLength"),d=["",""],w=[],N=0;N<a.length-1;N++)for(var y=N;y<a.length-1;y++)w.push([a[N],a[y+1]]);for(var F=[],b=[],A=0;A<w.length;A++){var R=[],C=[p,S];u=w[A][0][0].factor,h=w[A][1][0].factor,R.push(u,h);var V={};V.sheetid=i+u+" "+h,V.header=!0,t.push(V),F.push(R),n.push(i+u+" "+h),C.push(u,h,l),b.push(C);var _=[{wch:8},{wch:m},{wch:8},{wch:8},{wch:10}];o.push(_)}for(var x=0;x<w.length;x++){for(var D=[],T=0;T<w[x][0].length;T++){var z=[],L=w[x][0][T].statement,k=w[x][0][T].sortStatement,Z=w[x][0][T].zScore,I=w[x][1][T].zScore,Q=evenRound(w[x][0][T].zScore-w[x][1][T].zScore,3);z.push(L,k,Z,I,Q),D.push(z)}D.sort(function(t,e){return t[4]===e[4]?0:e[4]<t[4]?-1:1}),D.unshift(d,[g+" "+F[x][0]+" "+f+" "+F[x][1]],d,b[x]),s.push(D)}v(t,r,a,s,n,o)}function v(t,r,a,s,n,o){var u=e.getState("language"),h=(resources[u].translation["Z-Score Variance"],resources[u].translation["Consensus-Disagreement"]),c=resources[u].translation["Statement Number"],i=resources[u].translation.Statement,l=resources[u].translation["Z-Score Variance"],p=resources[u].translation["Factor Q-sort Values for Statements sorted by Consensus vs. Disagreement"],S=e.getState("sigFactorNumbersArray"),g=e.getState("userSelectedFactors"),v=e.getState("maxStatementLength"),m=["",""];S.sort();var d=[c,i],w=d.concat(g);w.push(l),n.push(h);for(var N=[{wch:8},{wch:v}],y=0,F=g.length;y<F;y++)N.push({wch:8});N.push({wch:15}),o.push(N);for(var b=[],A=0;A<a[0].length;A++){var R=[];R.push(a[0][A].statement,a[0][A].sortStatement);for(var C=[],V=0;V<a.length;V++){S[V];R.push(a[V][A].sortValue),C.push(a[V][A].zScore)}var _=evenRound(UTIL.variance(C),3);R.push(_),b.push(R)}var x=g.length+2;b.sort(function(t,e){return t[x]===e[x]?0:t[x]<e[x]?-1:1}),b.unshift(m,[p],m,w),s.push(b),f(t,r,a,S,s,n,o)}function f(t,r,a,s,n,o,u){var h=e.getState("language"),c=resources[h].translation["Factor Characteristics"],i=(resources[h].translation["Factor Number"],resources[h].translation["No. of Defining Variables"]),l=resources[h].translation["Avg. Rel. Coef."],p=resources[h].translation["Composite Reliability"],S=resources[h].translation["S.E. of Factor Z-scores"],g=e.getState("userSelectedFactors"),v=e.getState("sigSortsArray"),f=["",""];o.push(c);for(var d=[{wch:20}],w=0,N=g.length;w<N;w++)d.push({wch:8});u.push(d);var y=[],F=[""],b=F.concat(g);y.push(b);for(var A=[i],R=0;R<v.length;R++)A.push(v[R].SigSorts.length);y.push(A);for(var C=[l],V=0;V<v.length;V++)C.push(.8);y.push(C);for(var _,x,D=[p],T=[],z=0;z<v.length;z++)_=v[z].SigSorts.length,x=evenRound(.8*_/(1+.8*(_-1)),3),T.push(x),D.push(x);y.push(D);for(var L=[S],k=[],Z=0;Z<v.length;Z++){var I=evenRound(Math.sqrt(Math.abs(1-T[Z])),3);k.push(I),L.push(I)}y.push(L),y.unshift(f,[c],f),n.push(y),m(t,r,k,a,s,n,o,u)}function m(t,r,a,s,n,o,u,h){var c=e.getState("language"),i=resources[c].translation["Standard Errors for Diffs"],l=resources[c].translation["Standard Errors for Differences in Factor Z-scores"],p=e.getState("sigSortsArray"),S=e.getState("userSelectedFactors"),g=["",""];u.push(i);for(var v=[{wch:8}],f=0,m=S.length;f<m;f++)v.push({wch:8});h.push(v);var w=[],N=[""],y=N.concat(S);w.push(y);for(var F,b,A,R=[],C=[],V=0;V<p.length;V++){var _=[];_.push(p[V]["Factor Number"]);for(var x=0;x<p.length;x++){var D=[],T=[];D.push("Factor "+p[V]["Factor Number"]),T.push(p[V]["Factor Number"]),D.push("Factor "+p[x]["Factor Number"]),T.push(p[x]["Factor Number"]),F=a[V],b=a[x],A=evenRound(Math.sqrt(F*F+b*b),3),D.push(A),T.push(A),_.push(A),R.push(D),C.push(T)}w.push(_)}w.unshift(g,[l],g),o.push(w),d(t,r,p,s,R,C,n,o,u,h)}function d(t,r,a,s,n,o,u,h,c,i){var l=e.getState("language"),p=resources[l].translation["Dist State"],S=resources[l].translation["Consensus Statements"],g=e.getState("maxStatementLength"),v=e.getState("userSelectedFactors");b.calledTimes=0;for(var f=0;f<a.length;f++){c.push(p+a[f]["Factor Number"]);for(var m=[{wch:8},{wch:g},{wch:8}],d=0,N=v.length;d<N;d++)m.push({wch:8},{wch:8},{wch:8});i.push(m)}var A,R,C,V,x=[],D=[],T=[],z=[],L=[];for(R=0;R<a.length;R++){var k=[],Z=[],I=[],Q=[];for(C=0;C<s[0].length;C++){var P,H=!1,O=[],U=!1,q=[];for(V=0;V<a.length;V++)if(s[R][C].factor===s[V][C].factor);else{A=null;for(var M=0;M<o.length;M++){var X=o[M][0],G=o[M][1],j=u[R],B=u[V];X===j&&G===B&&(A=o[M][2])}Math.abs(s[R][C].zScore-s[V][C].zScore)>=1.96*A&&(s[R][C].zScore=evenRound(s[R][C].zScore,2),H=!0,O.push(H)),Math.abs(s[R][C].zScore-s[V][C].zScore)>=2.58*A&&(s[R][C].zScore=evenRound(s[R][C].zScore,2),U=!0,q.push(U))}P=C+1,O.length===u.length-1&&k.push(P),q.length===u.length-1&&Z.push(P),0===O.length&&I.push(P),0===q.length&&Q.push(P)}var E=_.uniq(k,!0),W=_.uniq(Z,!0),K=_.difference(E,W);z.push(K),L.push(W),x.push(I),D.push(Q);var $=u[R],Y=b(W,K,$,s,u);T.push(Y[0]),h.push(Y[1])}e.setState("masterDistingStatementNumbersArray01",L),e.setState("masterDistingStatementNumbersArray05",z),e.setState("distStatementDataVizArray",T),e.setState("outputForDataViz",s);do{x=F(x)}while(x.length>1);do{D=F(D)}while(D.length>1);var J=_.flatten(x),tt=_.flatten(D),et=_.xor(J,tt);e.setState("consensus05Statements",J),e.setState("consensus01Statements",et),c.push(S);for(var rt=[{wch:12},{wch:12},{wch:g},{wch:12}],at=0,st=v.length;at<st;at++)rt.push({wch:12},{wch:15},{wch:15});i.push(rt);var nt=y(J,et,s,u);e.setState("formattedConsensusStatements",nt[0]),h.push(nt[1]),w(t,r,h,c,i)}function w(t,r,a,s,n){function o(t,r){var a=e.getState("masterDistingStatementNumbersArray01"),s=e.getState("masterDistingStatementNumbersArray05"),n=e.getState("consensus05Statements"),o=e.getState("consensus01Statements");return _.contains(s[r],t)?"  D":_.contains(o,t)?"  C":_.contains(a[r],t)?"  D*":_.contains(n,t)?"  C*":""}for(var u,h,c,i,l,p,S=e.getState("language"),g=resources[S].translation[" Rel. Ranks"],v=resources[S].translation["Relative Ranking of Statements in "],f=resources[S].translation["Statement Number"],m=resources[S].translation["Z-score"],d=resources[S].translation.Distinguishing,w=resources[S].translation.Consensus,y=resources[S].translation["Highest Ranked Statements"],F=resources[S].translation["Positive Statements Ranked Higher in "],b=resources[S].translation["Array than in Other Factor Arrays"],A=resources[S].translation["Negative Statements Ranked Lower in "],R=resources[S].translation["Array than in Other Factor ArraysB"],C=resources[S].translation["Lowest Ranked Statements"],V=(e.getState("maxStatementLength"),resources[S].translation.Statement),x=resources[S].translation["Sort Values"],D=e.getState("statementRankingArray"),T=e.getState("userSelectedFactors"),z=[],L=[],k=e.getState("qavSortTriangleShape"),Z=e.getState("synFactorArray1Holder"),I=+_.max(k),Q=+_.min(k),P=_.countBy(k,_.identity),H=P[I],O=P[Q],U=0,q=T.length;U<q;U++){s.push(T[U]+g);var M=[{wch:8},{wch:80},{wch:8},{wch:12}];n.push(M),z=[[],[],[],[]],L=[[],[],[],[]],u=_.cloneDeep(Z[U]),u.sort(function(t,e){return t[f]-e[f]});for(var X=0,G=u.length;X<G;X++)u[X].rankArray=D[X];u.sort(function(t,e){return e[m]===t[m]?t[f]-e[f]:e[m]-t[m]});for(var j=0;j<O;j++){c=u.shift();var B=c[f],E=c[V],W=o(B,U),K=c[x],$=_.clone(c.rankArray);$.splice(U,1);var Y=[B,E,K,W],J=Y.concat($);L[0].push(J)}for(var tt=0;tt<H;tt++){h=u.pop();var et=h[f],rt=h[V],at=o(et,U),st=h[x],nt=_.clone(h.rankArray);nt.splice(U,1);var ot=[et,rt,st,at],ut=ot.concat(nt);L[3].unshift(ut)}for(var ht=0,ct=u.length;ht<ct;ht++){if((p=u[ht][x])>-1&&(i=_.max(u[ht].rankArray),p===i)){var it=_.clone(u[ht].rankArray);it.splice(U,1);var lt=u[ht][f],pt=o(lt,U),St=[lt,u[ht][V],p,pt],gt=St.concat(it);L[1].push(gt)}if(p<1&&(l=_.min(u[ht].rankArray),u[ht].rankArray[U],p===l)){var vt=_.clone(u[ht].rankArray);vt.splice(U,1);var ft=u[ht][f],mt=o(ft,U),dt=[ft,u[ht][V],p,mt],wt=dt.concat(vt);L[2].push(wt)}}var Nt=["",""],yt=T[U],Ft=_.clone(T);Ft.splice(U,1);var bt=["",F+yt+b],At=["",v+yt],Rt=["",y,yt,d].concat(Ft);L[0].unshift(Nt,At,["","","",w],Rt),L[1].unshift(Nt,bt);var Ct={};Ct.stateNum="",Ct.statement=A+yt+R,Ct.sortValue="",L[2].unshift(Nt,["",A+yt+R,""]);var Vt={};Vt.stateNum="",Vt.statement=C,Vt.sortValue="",L[3].unshift(Nt,["",C,""]),r.push(_.flattenDeep(z)),a.push(_.flatten(L))}N(t,r,a,s,n)}function N(t,r,a,s,n){e.setState("outputComplete","true"),e.setState("outputSpreadsheetArray",r),e.setState("outputSpreadsheetSheetNamesArray",t),e.setState("dataXlsx",a),e.setState("sheetNamesXlsx",s),e.setState("colSizes",n)}function y(t,r,a,s){var n=e.getState("language"),o=resources[n].translation["Consensus Statements"],u=resources[n].translation["Those That Do Not Distinguish Between ANY Pair of Factors"],h=resources[n].translation["All Listed Statements are Non-Significant at P > 0.01, and Those Flagged with an * are also Non-Significant at P > 0.05)"],c=resources[n].translation.Significance,i=resources[n].translation.Statement,l=(resources[n].translation.Num,resources[n].translation["Statement Number"]),p=resources[n].translation["Z-score"],S=["",""],g=a.length,v=t.length,f=r.length,m=[],d=[],w=[],N=[],y={};y["No."]=" ",y["SIG "]=" ",y["Statement "]=" ",y["Num "]=" ";for(var F=0;F<g;F++)y["Q-SV-"+s[F]]=" ",y["Z-SCR-"+s[F]]=" ",y["SIG"+s[F]]=" ";w.push(S,[o+" -- "+u],S,[h],S,S);var b=[];m.push(y);var A={};A["No."]=o+" -- "+u,m.push(A),m.push(y);var R={};R["No."]=h,m.push(R),m.push(y),m.push(y);var C={};C["No."]=l,C["SIG "]=c,C["Statement "]=i,C["Num "]=l,b.push(l,c,i,l);for(var V=0;V<g;V++)C["Q-SV-"+s[V]]=s[V]+" Q-SV",C["Z-SCR-"+s[V]]=s[V]+" "+p,b.push(s[V]+" Q-SV",s[V]+" "+p);m.push(C),w.push(b);for(var _,x,D,T,z=0;z<v;z++){_={};var L=[];D=t[z],_["No."]=D,_["SIG "]="*",_["Statement "]=a[0][D-1].sortStatement,_["Num "]=D,L.push(D,"*",a[0][D-1].sortStatement,D);for(var k=0;k<g;k++)_["Q-SV-"+s[k]]=a[k][D-1].sortValue,_["Z-SCR-"+s[k]]=a[k][D-1].zScore,L.push(a[k][D-1].sortValue,a[k][D-1].zScore);d.push(_),N.push(L)}for(var Z=0;Z<f;Z++){var I=[];x={},T=r[Z],x["No."]=T,x["SIG "]="",x["Statement "]=a[0][T-1].sortStatement,x["Num "]=T,I.push(T,"",a[0][T-1].sortStatement,T);for(var Q=0;Q<g;Q++)x["Q-SV-"+s[Q]]=a[Q][T-1].sortValue,x["Z-SCR-"+s[Q]]=a[Q][T-1].zScore,I.push(a[Q][T-1].sortValue,a[Q][T-1].zScore);d.push(x),N.push(I)}var P=d.sort(function(t,e){return t["No."]-e["No."]});N.sort(function(t,e){return t[0]===e[0]?0:t[0]<e[0]?-1:1});for(var H=w.concat(N),O=0;O<P.length;O++)m.push(P[O]);return[m,H]}function F(t){for(var e=[],r=0;r<t.length;r++){var a=r+1,s=_.intersection(t[r],t[a]);e.push(s)}return e.length>1&&e.pop(),e}function b(t,r,a,s,n){var o=e.getState("language"),u=resources[o].translation["Distinguishing Statements for"],h=resources[o].translation["(P < .05 : Asterisk (*) Indicates Significance at P < .01)"],c=resources[o].translation["Both the Factor Q-Sort Value and the Z-Score (Z-SCR) are Shown"],i=resources[o].translation.Significance,l=resources[o].translation.Statement,p=(resources[o].translation.Num,resources[o].translation["Statement Number"]),S=resources[o].translation["Z-score"],g=s.length,v=r.length,f=t.length,m=[],d=[],w=["",""],N=[],y=[u+a];N.push(w,y),N.push(w,[h]),N.push(w,[c],w,w);var F=[p,l,p],A={};A["No."]=" ",A["Statement "]=" ",A["Num "]=" ";for(var R=0;R<g;R++)A["Q-SV-"+n[R]]=" ",A["Z-SCR-"+n[R]]=" ",A["SIG"+n[R]]=" ";m.push(A);var C={};C["No."]=u+a,m.push(C),m.push(A);var V={};V["No."]=h,m.push(V),m.push(A);var _={};_["No."]=c,m.push(_),m.push(A),m.push(A);var x={};x["No."]=p,x["Statement "]=l,x["Num "]=p;for(var D=0;D<g;D++)x["Q-SV-"+n[D]]=n[D]+" Q-SV",x["Z-SCR-"+n[D]]=n[D]+" "+S,x["SIG"+n[D]]=i,F.push(n[D]+" Q-SV",n[D]+" "+S,i);m.push(x),N.push(F);for(var T,z,L,k,Z=[],I=0;I<v;I++){var Q=[];T={},L=r[I],T["No."]=L,Q.push(L),T["Statement "]=s[0][L-1].sortStatement,Q.push(s[0][L-1].sortStatement,L),T["Num "]=L;for(var P=0;P<g;P++)T["Q-SV-"+n[P]]=s[P][L-1].sortValue,T["Z-SCR-"+n[P]]=s[P][L-1].zScore,T["SIG"+n[P]]="",Q.push(s[P][L-1].sortValue,s[P][L-1].zScore,"");d.push(T),Z.push(Q)}for(var H=0;H<f;H++){var O=[];z={},k=t[H],z["No."]=k,z["Statement "]=s[0][k-1].sortStatement,z["Num "]=k,O.push(k,s[0][k-1].sortStatement,k);for(var U=0;U<g;U++)z["Q-SV-"+n[U]]=s[U][k-1].sortValue,z["Z-SCR-"+n[U]]=s[U][k-1].zScore,O.push(s[U][k-1].sortValue,s[U][k-1].zScore),U===b.calledTimes?(z["SIG"+n[U]]="*",O.push("*")):(z["SIG"+n[U]]="",O.push(""));d.push(z),Z.push(O)}for(var q=n[b.calledTimes],M="Z-SCR-"+q,X=d.sort(function(t,e){return e[M]-t[M]}),G=0;G<X.length;G++)m.push(X[G]);var j=b.calledTimes,B=[4,7,10,13,16,19,22,25],E=B[j];Z.sort(function(t,e){return t[E]===e[E]?0:e[E]<t[E]?-1:1});var W=N.concat(Z);return b.calledTimes++,[m,W]}t.generateOutput=function(){var t=[],r=[],s=e.getState("language"),n=resources[s].translation["Project Overview"],o=resources[s].translation.Undo,u=resources[s].translation["Analysis Completed on"],h=resources[s].translation["Total Number of Statements"],c=resources[s].translation["Q-sort Triangle Shape"],i=resources[s].translation["Total Number of Q-sorts"],l=resources[s].translation["Analysis Process"],p=resources[s].translation["Project name"],S=resources[s].translation.versionNumber,g={sheetid:n,headers:!1};t.push(g);var v=[];v.push(n);var f=[],m=[],d=["",""],w=e.getState("qavProjectName"),N=[p,w];m.push(d,N,d),f.push(d,N,d);var y=e.getState("qavOriginalSortSize"),F=[h,y];m.push(F,d),f.push(F,d);var b=e.getState("qavSortTriangleShape"),A=b.join(),R=[c,A];m.push(R,d),f.push(R,d);var C=e.getState("qavTotalNumberSorts"),V=[i,C];m.push(V,d),f.push(V,d);var _,x,D,T=document.getElementById("rotationHistoryList"),z=T.childNodes;m.push([l,""]),f.push([l,""]);for(var L=0;L<z.length;L++){var k=[];_=L+1,x=z[L].textContent,D=x.replace(o,""),k.push(_,D),m.push(k),f.push(k)}var Z=e.getState("language");m.push(d,["Language",Z]),f.push(d,["Language",Z]);var I=UTIL.currentDate1()+" at "+UTIL.currentTime1();m.push(d,[u+I,""]),f.push(d,[u+I,""]),m.push(d,["Version Number: ",S]),f.push(d,["Version Number: ",S]);var Q=[[{wch:40},{wch:70}]],P=[];P.push(f),r.push(m),a(t,r,P,v,Q)},t.downloadExcelOutputFile=function(){function t(){if(!(this instanceof t))return new t;this.SheetNames=[],this.Sheets={}}for(var r=e.getState("dataXlsx"),a=e.getState("sheetNamesXlsx"),s=e.getState("colSizes"),n=new t,o=0;o<a.length;o++){var u=function(t,e){for(var r={},a={s:{c:1e7,r:1e7},e:{c:0,r:0}},s=0;s!=t.length;++s)for(var n=0;n!=t[s].length;++n){a.s.r>s&&(a.s.r=s),a.s.c>n&&(a.s.c=n),a.e.r<s&&(a.e.r=s),a.e.c<n&&(a.e.c=n);var o={v:t[s][n]};if(null!==o.v){var u=XLSX.utils.encode_cell({c:n,r:s});"number"==typeof o.v?o.t="n":"boolean"==typeof o.v?o.t="b":o.v instanceof Date?(o.t="n",o.z=XLSX.SSF._table[14],o.v=datenum(o.v)):o.t="s",r[u]=o}}return a.s.c<1e7&&(r["!ref"]=XLSX.utils.encode_range(a)),r}(r[o]);u["!cols"]=s[o],n.SheetNames.push(a[o]),n.Sheets[a[o]]=u}var h=XLSX.write(n,{bookType:"xlsx",bookSST:!0,type:"binary"}),c=UTIL.currentDate1()+"_"+UTIL.currentTime1(),i=e.getState("qavProjectName"),l="KenQ_output_"+i+"_"+c+".xlsx";saveAs(new Blob([function(t){for(var e=new ArrayBuffer(t.length),r=new Uint8Array(e),a=0;a!=t.length;++a)r[a]=255&t.charCodeAt(a);return e}(h)],{type:"application/octet-stream"}),l)},t.downloadCsvOutputFile=function(){for(var t=e.getState("dataXlsx"),r=["","",""],a=[],s=0,n=t.length;s<n;s++){for(var o=0,u=t[s].length;o<u;o++)a.push(t[s][o]);a.push(r,r,r,r,r,r)}a.shift();var h=UTIL.currentDate1()+"_"+UTIL.currentTime1(),c=e.getState("qavProjectName"),i="KenQ_output_"+c+"_"+h+".csv";UTIL.exportToCsv(i,a)}}(window.OUTPUT=window.OUTPUT||{},QAV)}});