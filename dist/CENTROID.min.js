!function(e){function t(a){if(n[a])return n[a].exports;var r=n[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var n={};t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:a})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t){!function(e,t,n){e.fireFactorExtraction=function(){var n,a,r,o,u,c,i,l,s,d,f=performance.now(),h=document.getElementById("factorSelect"),g=h.options[h.selectedIndex].value,p=parseInt(g),v=t.getState("originalCorrelationValues"),m=[],x=[],R=[],b=[],E=[];t.setState("numberFactorsExtracted",p),t.numFactorsExtracted=p;var F,S,C,V,y,M,q,w,T=p+1;for(l=$("#factorRotationTable2 tr").length,l>0?"destroy":"no",s=t.getState("language"),d=resources[s].translation.Factor,F=1;F<T;F++)a=d+" "+F,r=d+" "+F,R.push(r),o=e.calculateFactorLoadings(v),m.push(o[0]),v=o[1],x.push(a);t.setState("factorLabels",x),u=_.cloneDeep(m,!0);var I=_.cloneDeep(m);t.setState("centroidFactors",I),c=t.getState("qavTotalNumberSorts"),i=t.getState("qavRespondentNames"),explainedVarianceAndEigens=e.calcEigenValues(u,c),b=explainedVarianceAndEigens[0],E=explainedVarianceAndEigens[1],S=[],_(m).forEach(function(e){var t=_.map(e,function(e){return evenRound(e,5)});S.push(t)}).value(),S.unshift(i),C=_.zip.apply(_,S),V=resources[s].translation["% explained variance"],y=resources[s].translation.Eigenvalues,b.unshift(y),E.unshift(V),t.centroidEigenvalues=b,C.push(b),C.push(E),x.unshift(""),C.unshift(x),M=C.pop(),t.setState("expVarCentroid",M),t.setState("factorMatrixTransposed",C),n=performance.now(),console.log("%c Centroid factor extraction completed in  "+(n-f).toFixed(0)+" milliseconds","background: #FF5733; color: white"),q=_.cloneDeep(S),q.shift(),w=_.zip.apply(_,q),t.centroidFactors=w},e.calcEigenValues=function(e,t){for(var n=[],a=[],r=0,o=e.length;r<o;r++){for(num=e[r],q=0,qLen=num.length;q<qLen;q++)num[q]=evenRound(num[q]*num[q],8);eigen=evenRound(_.reduce(num,function(e,t){return e+t}),5),a.push(eigen),totalVariance=evenRound(eigen/t*100,0),n.push(totalVariance)}return[a,n]},e.calculateFactorLoadings=function(t){var n=e.checkPositiveManifold(t),a=n[0],r=n[1],o=n[2],u=e.calculateFactor(a,r),c=e.removeCorrelations(a,u),i=e.undoReflection(c,u,o),l=i[0];return[i[1],l]},e.drawExtractedFactorsTable=function(){var n,a,r,o,u,c,i,l,s,d,f,h,g,p,v=t.getState("centroidFactors"),m={};for(u=t.getState("respondentNames")||[],""===u[0]&&u.shift(),n=0,a=v.length;n<a;n++)r=n+1,v[n].unshift(r,u[n]);for(f=t.getState("language"),h=resources[f].translation.Factor,g=resources[f].translation.Respondent,p=resources[f].translation["Centroid Factors Extracted"],d=[{title:"Num."},{title:g}],i=v[0].length-2,o=0;o<i;o++)c={},c.title=h+" "+(o+1),d.push(c);l=[2,3,4,5,6,7,8,9],s=l.slice(0,i),m.domElement="#factorRotationTable1",m.fixed=!1,m.data=v,m.headers=d,m.colDefs=[{targets:[0,1],className:"dt-head-center dt-body-center dt-body-name"},{targets:s,className:"dt-head-center dt-body-right"},{targets:"_all",createdCell:function(e,t){t<0&&$(e).css("color","red")}}],UTIL.drawDatatable(m),$("#rotationHistoryList").append("<li>"+t.numFactorsExtracted+p+"</li>"),e.createFooterTable(d,s)},e.createFooterTable=function(e,n){var a,r,o,u,c,i=[],l=[],s={},d=0,f=t.getState("language"),h=resources[f].translation["Cum % Expln Var"],g=s,p={};for(a=t.getState("centroidEigenvalues"),a.unshift(""),r=t.getState("expVarCentroid"),r.unshift(""),o=r.length,u=2;u<o;u++)d+=r[u],l.push(d);return l.unshift("",h),i.push(a,r,l),c=e.slice(2,e.length),s.title="",c.unshift(s,g),p.domElement="#factorRotationTable1Footer",p.fixed=!1,p.data=i,p.headers=c,p.ordering=!1,p.colDefs=[{targets:[0,1],className:"dt-head-center dt-body-center dt-body-name"},{targets:n,className:"dt-head-center dt-body-right"},{targets:"_all",createdCell:function(e,t){t<0&&$(e).css("color","red")}}],UTIL.drawDatatable(p),p},e.calculateFactor=function(e,t){console.time("total calculation time ");for(var n,a,r,o,u,c=[],i=0,l=t.length;i<l;i++)c.push(evenRound(t[i]+.5,8));n=_.reduce(c,function(e,t){return e+t}),a=evenRound(Math.sqrt(n),8),r=_.map(c,function(e){return evenRound(e/a,8)}),o=_.map(r,function(e){return evenRound(e*e,8)}),u=[];for(var s=0,d=o.length;s<d;s++)u.push(Math.abs(evenRound(o[s]-.5,8)));var f=_.max(u);if(f>.001){do{for(var h=o,g=[],p=0,v=t.length;p<v;p++)g.push(evenRound(t[p]+h[p],8));n=function(e){return _.reduce(e,function(e,t){return evenRound(e+t,8)})}(g),a=evenRound(Math.sqrt(n),8),r=function(e){return r=_.map(e,function(e){return evenRound(e/a,8)})}(g),o=function(e){return o=_.map(e,function(e){return evenRound(e*e,8)})}(r),u=[];for(var m=0,x=h.length;m<x;m++)u.push(Math.abs(evenRound(h[m]-o[m],8)));f=_.max(u)}while(f>.001);return console.timeEnd("total calculation time "),r}return r},e.removeCorrelations=function(e,t){for(var n=[],a=0,r=t.length;a<r;a++){var o=[];o=function(e){return _(e).forEach(function(t){var n=t*e[a];o.push(evenRound(n,8))}).value(),o}(t),n.push(o)}for(var u=[],c=0,i=t.length;c<i;c++){for(var l=[],s=0,d=t.length;s<d;s++)l.push(evenRound(e[c][s]-n[c][s],8));u.push(l)}for(var f=0,h=t.length;f<h;f++){var g=f;u[f][g]=1}return u},e.undoReflection=function(e,t,n){return _(n).forEach(function(n){for(var a=0;a<e.length;a++)e[a][n]=-1*e[a][n];for(var r=0;r<e[n].length;r++)e[n][r]=-1*e[n][r];t[n]=-1*t[n]}).value(),[e,t]},e.checkPositiveManifold=function(t){var n=e.calculateColumnSums(t),a=e.calculateMinValueAndIndex(n),r=a[0];return r<0?e.calculatePositiveManifold(t,r):[t,n]},e.calculatePositiveManifold=function(t,n){for(var a,r,o,u,c,i,l=[],s=t.length;n<0;){if(a=e.calculateColumnSums(t),r=e.calculateMinValueAndIndex(a),n=r[0],o=r[1],!(n<0))return[t,a,l];for(u=0;u<s;u++)t[u][o]=-1*t[u][o];for(c=0,i=t[o].length;c<i;c++)t[o][c]=-1*t[o][c];l.push(o)}},e.calculateColumnSums=function(e){var t,n,a,r,o=[],u=e.length;for(a=0;a<u;a++){for(t=0,r=0;r<u;r++)t+=e[r][a];t-=1,n=evenRound(t,8),o.push(n)}return o},e.calculateMinValueAndIndex=function(e){var t,n=0,a=e[0],r=e.length;for(t=1;t<r;t++)e[t]<a&&(n=t,a=e[t]);return[a,n]}}(window.CENTROID=window.CENTROID||{},QAV)}]);